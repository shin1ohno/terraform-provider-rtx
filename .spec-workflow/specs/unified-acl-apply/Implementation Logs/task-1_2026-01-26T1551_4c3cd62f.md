# Implementation Log: Task 1

**Summary:** Created ACL schema common utilities file with shared schema definitions, helper functions, and validation logic for all ACL types in the unified ACL design pattern.

**Timestamp:** 2026-01-26T15:51:44.246Z
**Log ID:** 4c3cd62f-3794-4aae-b295-41d01848bb7d

---

## Statistics

- **Lines Added:** +460
- **Lines Removed:** -0
- **Files Changed:** 1
- **Net Change:** 460

## Files Modified
_No files modified_

## Files Created
- internal/provider/acl_schema_common.go

---

## Artifacts

### Functions

#### CommonACLSchema
- **Purpose:** Returns shared schema attributes (name, sequence_start, sequence_step, apply) for all ACL types
- **Location:** internal/provider/acl_schema_common.go:82
- **Signature:** func CommonACLSchema() map[string]*schema.Schema
- **Exported:** Yes

#### CommonApplySchema
- **Purpose:** Returns the schema for apply blocks (interface, direction, filter_ids) used to bind ACLs to interfaces
- **Location:** internal/provider/acl_schema_common.go:125
- **Signature:** func CommonApplySchema() *schema.Resource
- **Exported:** Yes

#### CommonEntrySchema
- **Purpose:** Returns base schema for entry blocks with common attributes (sequence, log) shared by all ACL entry types
- **Location:** internal/provider/acl_schema_common.go:166
- **Signature:** func CommonEntrySchema() map[string]*schema.Schema
- **Exported:** Yes

#### BuildACLFromResourceData
- **Purpose:** Extracts common ACL fields from ResourceData, handling both auto and manual sequence modes
- **Location:** internal/provider/acl_schema_common.go:199
- **Signature:** func BuildACLFromResourceData(d *schema.ResourceData) CommonACL
- **Exported:** Yes

#### ValidateACLSchema
- **Purpose:** CustomizeDiff validation function that validates auto/manual sequence mode consistency and detects mode mixing
- **Location:** internal/provider/acl_schema_common.go:280
- **Signature:** func ValidateACLSchema(ctx context.Context, diff *schema.ResourceDiff, meta interface{}) error
- **Exported:** Yes

#### validateApplyBlocks
- **Purpose:** Internal helper that validates apply blocks for duplicate interface+direction combinations and duplicate filter_ids
- **Location:** internal/provider/acl_schema_common.go:356
- **Signature:** func validateApplyBlocks(diff *schema.ResourceDiff) error
- **Exported:** No

#### CalculateEntrySequences
- **Purpose:** Calculates sequence numbers for all entries based on auto mode (sequence_start+step) or manual mode
- **Location:** internal/provider/acl_schema_common.go:413
- **Signature:** func CalculateEntrySequences(acl CommonACL) []int
- **Exported:** Yes

#### InterfaceSupportsACLType
- **Purpose:** Validates interface type supports the given ACL type (e.g., MAC ACLs not supported on PP/Tunnel interfaces)
- **Location:** internal/provider/acl_schema_common.go:441
- **Signature:** func InterfaceSupportsACLType(interfaceName string, aclType ACLType) error
- **Exported:** Yes

### Classes

#### ACLType
- **Purpose:** String type representing ACL types (ip, ipv6, mac, ip_dynamic, ipv6_dynamic, extended) for command generation and validation
- **Location:** internal/provider/acl_schema_common.go:29
- **Exported:** Yes

#### CommonACL
- **Purpose:** Struct representing common fields extracted from ACL resource data including name, sequence settings, entries, and applies
- **Location:** internal/provider/acl_schema_common.go:50
- **Exported:** Yes

#### ACLEntry
- **Purpose:** Struct representing a single ACL entry with sequence number and ACL-type specific fields
- **Location:** internal/provider/acl_schema_common.go:59
- **Exported:** Yes

#### ACLApply
- **Purpose:** Struct representing an interface binding configuration for an ACL (interface, direction, filter_ids)
- **Location:** internal/provider/acl_schema_common.go:65
- **Exported:** Yes

