{
  "id": "snapshot_1769326276220_mq3i646j2",
  "approvalId": "approval_1769326276064_2fn1iv66f",
  "approvalTitle": "Requirements: Filter Attribute Consolidation",
  "version": 1,
  "timestamp": "2026-01-25T07:31:16.220Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Requirements: Filter Attribute Consolidation\n\n## Overview\n\nConsolidate filter-related attributes from `rtx_interface` resource into dedicated `rtx_interface_acl` and `rtx_interface_mac_acl` resources, and standardize attribute naming to follow `access_list_*` convention for consistency with `rtx_access_list_*` resources.\n\n## Problem Statement\n\n### Current State\n\n1. **rtx_interface** has filter attributes:\n   - `secure_filter_in` / `secure_filter_out` - IP filter numbers\n   - `dynamic_filter_out` - dynamic filter numbers (no `dynamic_filter_in`)\n   - `ethernet_filter_in` / `ethernet_filter_out` - MAC filter numbers\n\n2. **rtx_interface_acl** has:\n   - `ip_access_group_in` / `ip_access_group_out` - access list names\n   - `dynamic_filters_in` / `dynamic_filters_out` - dynamic filter numbers\n   - `ipv6_access_group_in` / `ipv6_access_group_out` - IPv6 access list names\n   - `ipv6_dynamic_filters_in` / `ipv6_dynamic_filters_out` - IPv6 dynamic filter numbers\n\n3. **rtx_interface_mac_acl** has:\n   - `mac_access_group_in` / `mac_access_group_out` - access list names\n\n### Issues\n\n1. **Naming inconsistency**: `secure_filter_*` vs `ip_access_group_*` vs `dynamic_filters_*`\n2. **Overlapping functionality**: Both `rtx_interface` and `rtx_interface_acl` can apply IP filters\n3. **Incomplete implementation**: `dynamic_filter_out` exists but no `dynamic_filter_in`\n4. **Resource name mismatch**: Attributes don't align with `rtx_access_list_*` resource naming\n\n### Impact\n\n- User confusion about which resource to use for filter application\n- Inconsistent naming makes learning the provider difficult\n- Dual implementation leads to maintenance burden\n\n## Requirements\n\n### Requirement 1: Remove Filter Attributes from rtx_interface\n\n**User Story:** As a Terraform user, I want a single, clear way to apply filters to interfaces, so that I don't have to choose between multiple approaches.\n\n#### Acceptance Criteria\n\n1. WHEN upgrading to new provider version THEN `secure_filter_in`, `secure_filter_out`, `dynamic_filter_out`, `ethernet_filter_in`, `ethernet_filter_out` SHALL be removed from `rtx_interface` schema\n2. WHEN users have existing configurations using these attributes THEN Terraform SHALL report clear error messages directing them to use dedicated resources\n3. WHEN `rtx_interface` is read THEN filter-related configuration SHALL NOT be included in the resource state\n\n### Requirement 2: Standardize Attribute Naming to access_list Format\n\n**User Story:** As a Terraform user, I want consistent attribute naming across resources, so that I can easily understand and use the provider.\n\n#### Acceptance Criteria\n\n1. WHEN `rtx_interface_acl` schema is defined THEN attributes SHALL follow `access_list_ip_*` and `access_list_ipv6_*` naming pattern\n2. WHEN `rtx_interface_mac_acl` schema is defined THEN attributes SHALL follow `access_list_mac_*` naming pattern\n3. WHEN dynamic filter attributes are defined THEN they SHALL follow `ip_filter_dynamic_*` and `ipv6_filter_dynamic_*` naming pattern\n\n### Requirement 3: Enhanced rtx_interface_acl Resource\n\n**User Story:** As a Terraform user, I want the dedicated ACL resource to support all filter application methods, so that I have full functionality in one place.\n\n#### Acceptance Criteria\n\n1. WHEN applying IP filters THEN resource SHALL support both access list names AND filter numbers\n2. WHEN applying IPv6 filters THEN resource SHALL support both access list names AND filter numbers\n3. WHEN applying dynamic filters THEN resource SHALL support both inbound AND outbound directions\n\n### Requirement 4: Enhanced rtx_interface_mac_acl Resource\n\n**User Story:** As a Terraform user applying Layer 2 filters, I want the dedicated MAC ACL resource to support all MAC filter application methods.\n\n#### Acceptance Criteria\n\n1. WHEN applying MAC filters THEN resource SHALL support both access list names AND filter numbers\n2. WHEN applying ethernet filters THEN resource SHALL support both inbound AND outbound directions\n\n### Requirement 5: Migration Documentation\n\n**User Story:** As an existing user, I want clear migration documentation, so that I can update my configurations smoothly.\n\n#### Acceptance Criteria\n\n1. WHEN breaking changes are released THEN documentation SHALL include migration examples\n2. WHEN deprecated attributes are removed THEN CHANGELOG SHALL clearly document the changes\n3. WHEN users need to migrate THEN examples SHALL show before/after configurations\n\n## Proposed Schema Changes\n\n### rtx_interface (Remove)\n\nRemove these attributes:\n- `secure_filter_in`\n- `secure_filter_out`\n- `dynamic_filter_out`\n- `ethernet_filter_in`\n- `ethernet_filter_out`\n\n### rtx_interface_acl (Rename)\n\n| Current Name | New Name |\n|--------------|----------|\n| `ip_access_group_in` | `access_list_ip_in` |\n| `ip_access_group_out` | `access_list_ip_out` |\n| `ipv6_access_group_in` | `access_list_ipv6_in` |\n| `ipv6_access_group_out` | `access_list_ipv6_out` |\n| `dynamic_filters_in` | `ip_filter_dynamic_in` |\n| `dynamic_filters_out` | `ip_filter_dynamic_out` |\n| `ipv6_dynamic_filters_in` | `ipv6_filter_dynamic_in` |\n| `ipv6_dynamic_filters_out` | `ipv6_filter_dynamic_out` |\n\nNew attributes:\n- `ip_filter_in` (List of Number) - static IP filter numbers\n- `ip_filter_out` (List of Number) - static IP filter numbers\n\n### rtx_interface_mac_acl (Rename)\n\n| Current Name | New Name |\n|--------------|----------|\n| `mac_access_group_in` | `access_list_mac_in` |\n| `mac_access_group_out` | `access_list_mac_out` |\n\nNew attributes:\n- `ethernet_filter_in` (List of Number) - ethernet filter numbers\n- `ethernet_filter_out` (List of Number) - ethernet filter numbers\n\n## Non-Functional Requirements\n\n### Backward Compatibility\n\n- This is a **breaking change** in a minor version\n- Clear deprecation warnings in release notes\n- Migration guide with code examples\n\n### Documentation\n\n- Update all affected resource documentation\n- Update examples to use new attribute names\n- Update master specs to reflect changes\n\n### Testing\n\n- Unit tests for new attribute names\n- Integration tests for filter application\n- Migration test scenarios\n\n## Out of Scope\n\n- Changes to underlying RTX commands (only schema changes)\n- Changes to `rtx_ip_filter_dynamic` or `rtx_access_list_*` resources\n- Automatic migration tooling\n\n## Technical Constraints\n\n- RTX routers have specific command formats that must be preserved\n- Filter number ranges vary by filter type (1-512 for ethernet, 1-65535 for IP)\n- Interface names must match RTX naming conventions\n\n## References\n\n- Related resources: `rtx_access_list_ip`, `rtx_access_list_ipv6`, `rtx_access_list_mac`\n- Affected files:\n  - `internal/provider/resource_rtx_interface.go`\n  - `internal/provider/resource_rtx_interface_acl.go`\n  - `internal/provider/resource_rtx_interface_mac_acl.go`\n  - `internal/client/interface_service.go`\n  - `internal/client/ip_filter_service.go`\n  - `internal/client/ethernet_filter_service.go`\n",
  "fileStats": {
    "size": 6924,
    "lines": 170,
    "lastModified": "2026-01-25T07:02:05.242Z"
  },
  "comments": []
}