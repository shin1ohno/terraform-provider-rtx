{
  "id": "snapshot_1768916738626_14ep5r5jl",
  "approvalId": "approval_1768916020744_1ecuaa6fa",
  "approvalTitle": "Tasks: Parser Edge Case Tests (19 tasks)",
  "version": 2,
  "timestamp": "2026-01-20T13:45:38.626Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# Tasks Document: Parser Edge Case Tests\n\n## Phase 1: IPsec Edge Cases\n\n- [ ] 1. Add IPsec encryption algorithm edge case tests\n  - File: internal/rtx/parsers/ipsec_tunnel_test.go\n  - Add TestParseIPsecEncryptionAlgorithms with all algorithm variants\n  - Test: DES-CBC, 3DES-CBC, AES-128-CBC, AES-256-CBC, AES-GCM-128, AES-GCM-256\n  - Purpose: Ensure all encryption algorithms parse correctly\n  - _Leverage: internal/rtx/testdata/patterns/ipsec.yaml, existing ipsec_tunnel_test.go patterns_\n  - _Requirements: REQ-1.1_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseIPsecEncryptionAlgorithms covering all encryption algorithm variants from REQ-1.1, using table-driven tests referencing ipsec.yaml patterns | Restrictions: Do not modify parser code, only add tests, maintain test independence | Success: All encryption algorithms tested, tests pass, edge cases documented_\n\n- [ ] 2. Add IPsec hash algorithm edge case tests\n  - File: internal/rtx/parsers/ipsec_tunnel_test.go\n  - Add TestParseIPsecHashAlgorithms with all hash variants\n  - Test: MD5, SHA-1, SHA-256, SHA-384, SHA-512\n  - Purpose: Ensure all hash algorithms parse correctly\n  - _Leverage: internal/rtx/testdata/patterns/ipsec.yaml_\n  - _Requirements: REQ-1.1_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseIPsecHashAlgorithms covering all hash algorithm variants | Restrictions: Table-driven tests only | Success: All hash algorithms tested_\n\n- [ ] 3. Add IPsec IKE version edge case tests\n  - File: internal/rtx/parsers/ipsec_tunnel_test.go\n  - Add TestParseIPsecIKEVersions for IKEv1/IKEv2 configurations\n  - Test: Main mode, aggressive mode, IKEv2 specific options\n  - Purpose: Ensure IKE version configurations parse correctly\n  - _Leverage: internal/rtx/testdata/patterns/ipsec.yaml_\n  - _Requirements: REQ-1.2_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseIPsecIKEVersions for all IKE version configurations from REQ-1.2 | Restrictions: Include both IKEv1 and IKEv2 edge cases | Success: All IKE versions tested_\n\n- [ ] 4. Add IPsec NAT traversal edge case tests\n  - File: internal/rtx/parsers/ipsec_tunnel_test.go\n  - Add TestParseIPsecNATTraversal for NAT-T options\n  - Test: NAT-T enabled/disabled, keep-alive intervals, port configurations\n  - Purpose: Ensure NAT traversal configurations parse correctly\n  - _Leverage: internal/rtx/testdata/patterns/ipsec.yaml_\n  - _Requirements: REQ-1.3_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseIPsecNATTraversal for NAT-T configurations from REQ-1.3 | Success: All NAT-T options tested_\n\n- [ ] 5. Add IPsec authentication edge case tests\n  - File: internal/rtx/parsers/ipsec_tunnel_test.go\n  - Add TestParseIPsecAuthentication for auth methods\n  - Test: PSK with special characters, certificate references, XAUTH\n  - Purpose: Ensure authentication configurations parse correctly\n  - _Leverage: internal/rtx/testdata/patterns/ipsec.yaml_\n  - _Requirements: REQ-1.4_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseIPsecAuthentication for all authentication methods from REQ-1.4 | Restrictions: Test special characters in PSK | Success: All auth methods tested_\n\n## Phase 2: OSPF Edge Cases\n\n- [ ] 6. Add OSPF area type edge case tests\n  - File: internal/rtx/parsers/ospf_test.go\n  - Add TestParseOSPFAreaTypes with all area type variants\n  - Test: Normal areas, stub, NSSA, totally stubby\n  - Purpose: Ensure all OSPF area types parse correctly\n  - _Leverage: internal/rtx/testdata/patterns/ospf.yaml, existing ospf_test.go patterns_\n  - _Requirements: REQ-2.1_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseOSPFAreaTypes covering all area type variants from REQ-2.1 | Success: All area types tested_\n\n- [ ] 7. Add OSPF authentication edge case tests\n  - File: internal/rtx/parsers/ospf_test.go\n  - Add TestParseOSPFAuthentication with all auth options\n  - Test: No auth, simple password, MD5 with key-id\n  - Purpose: Ensure OSPF authentication parses correctly\n  - _Leverage: internal/rtx/testdata/patterns/ospf.yaml_\n  - _Requirements: REQ-2.2_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseOSPFAuthentication for all authentication options from REQ-2.2 | Success: All auth options tested_\n\n- [ ] 8. Add OSPF redistribution edge case tests\n  - File: internal/rtx/parsers/ospf_test.go\n  - Add TestParseOSPFRedistribution with all redistribution options\n  - Test: Static, connected, with metrics, metric-type, prefix-lists\n  - Purpose: Ensure OSPF redistribution parses correctly\n  - _Leverage: internal/rtx/testdata/patterns/ospf.yaml_\n  - _Requirements: REQ-2.3_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseOSPFRedistribution for all redistribution options from REQ-2.3 | Success: All redistribution options tested_\n\n- [ ] 9. Add OSPF interface settings edge case tests\n  - File: internal/rtx/parsers/ospf_test.go\n  - Add TestParseOSPFInterfaceSettings with all interface options\n  - Test: Cost, priority, hello/dead intervals, network types\n  - Purpose: Ensure OSPF interface settings parse correctly\n  - _Leverage: internal/rtx/testdata/patterns/ospf.yaml_\n  - _Requirements: REQ-2.4_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseOSPFInterfaceSettings for all interface options from REQ-2.4 | Success: All interface settings tested_\n\n## Phase 3: NAT Edge Cases\n\n- [ ] 10. Add NAT port range edge case tests\n  - File: internal/rtx/parsers/nat_masquerade_test.go\n  - Add TestParseNATPortRanges with port mapping variants\n  - Test: Single port, port ranges (1000-2000), multiple protocols\n  - Purpose: Ensure NAT port ranges parse correctly\n  - _Leverage: internal/rtx/testdata/patterns/nat.yaml, existing nat_masquerade_test.go patterns_\n  - _Requirements: REQ-3.1_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseNATPortRanges for all port mapping variants from REQ-3.1 | Success: All port range formats tested_\n\n- [ ] 11. Add NAT protocol edge case tests\n  - File: internal/rtx/parsers/nat_masquerade_test.go\n  - Add TestParseNATProtocols with all protocol variants\n  - Test: TCP-only, UDP-only, ICMP, any/all protocols\n  - Purpose: Ensure NAT protocol handling parses correctly\n  - _Leverage: internal/rtx/testdata/patterns/nat.yaml_\n  - _Requirements: REQ-3.2_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseNATProtocols for all protocol variants from REQ-3.2 | Success: All protocols tested_\n\n- [ ] 12. Add NAT dynamic pool edge case tests\n  - File: internal/rtx/parsers/nat_masquerade_test.go\n  - Add TestParseNATDynamic with dynamic NAT options\n  - Test: Pool configurations, address ranges, overload (PAT)\n  - Purpose: Ensure dynamic NAT configurations parse correctly\n  - _Leverage: internal/rtx/testdata/patterns/nat.yaml_\n  - _Requirements: REQ-3.3_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseNATDynamic for all dynamic NAT options from REQ-3.3 | Success: All dynamic NAT options tested_\n\n- [ ] 13. Add NAT static edge case tests\n  - File: internal/rtx/parsers/nat_static_test.go\n  - Add TestParseNATStaticEdgeCases with static NAT variants\n  - Test: 1:1 mappings with ports, inside/outside inversions, hairpinning\n  - Purpose: Ensure static NAT edge cases parse correctly\n  - _Leverage: internal/rtx/testdata/patterns/nat.yaml_\n  - _Requirements: REQ-3.4_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseNATStaticEdgeCases for all static NAT variants from REQ-3.4 | Success: All static NAT edge cases tested_\n\n## Phase 4: BGP Edge Cases\n\n- [ ] 14. Add BGP route-map edge case tests\n  - File: internal/rtx/parsers/bgp_test.go\n  - Add TestParseBGPRouteMap with route-map options\n  - Test: In/out route-maps, multiple clauses, match/set actions\n  - Purpose: Ensure BGP route-map configurations parse correctly\n  - _Leverage: internal/rtx/testdata/patterns/bgp.yaml, existing bgp_test.go patterns_\n  - _Requirements: REQ-4.1_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseBGPRouteMap for all route-map options from REQ-4.1 | Success: All route-map options tested_\n\n- [ ] 15. Add BGP 4-byte ASN edge case tests\n  - File: internal/rtx/parsers/bgp_test.go\n  - Add TestParseBGP4ByteASN with ASN format variants\n  - Test: asdot notation (1.65535), asplain notation (65536), private ASN\n  - Purpose: Ensure 4-byte ASN formats parse correctly\n  - _Leverage: internal/rtx/testdata/patterns/bgp.yaml_\n  - _Requirements: REQ-4.2_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseBGP4ByteASN for all ASN format variants from REQ-4.2 | Success: All ASN formats tested_\n\n- [ ] 16. Add BGP community edge case tests\n  - File: internal/rtx/parsers/bgp_test.go\n  - Add TestParseBGPCommunity with community attribute variants\n  - Test: Standard (AA:NN), well-known (no-export, no-advertise), extended\n  - Purpose: Ensure BGP community attributes parse correctly\n  - _Leverage: internal/rtx/testdata/patterns/bgp.yaml_\n  - _Requirements: REQ-4.3_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseBGPCommunity for all community attribute variants from REQ-4.3 | Success: All community formats tested_\n\n- [ ] 17. Add BGP neighbor advanced edge case tests\n  - File: internal/rtx/parsers/bgp_test.go\n  - Add TestParseBGPNeighborAdvanced with advanced neighbor options\n  - Test: eBGP multihop, TTL security, update-source, password with special chars, timers\n  - Purpose: Ensure advanced BGP neighbor options parse correctly\n  - _Leverage: internal/rtx/testdata/patterns/bgp.yaml_\n  - _Requirements: REQ-4.4_\n  - _Prompt: Role: Go Test Developer | Task: Implement TestParseBGPNeighborAdvanced for all advanced neighbor options from REQ-4.4 | Success: All advanced options tested_\n\n## Phase 5: Validation and Cleanup\n\n- [ ] 18. Run full test suite and verify coverage\n  - File: (all test files)\n  - Run go test with coverage report\n  - Verify all new tests pass\n  - Document any discovered parser issues\n  - Purpose: Ensure all edge case tests are valid and complete\n  - _Leverage: go test -cover, existing test infrastructure_\n  - _Requirements: All_\n  - _Prompt: Role: QA Engineer | Task: Run full test suite with coverage, verify all edge case tests pass, document results | Success: All tests pass, coverage improved, no parser bugs discovered_\n\n- [ ] 19. Update pattern catalogs with edge case examples\n  - File: internal/rtx/testdata/patterns/ipsec.yaml, ospf.yaml, nat.yaml, bgp.yaml\n  - Add edge case examples to pattern catalogs\n  - Document test case to pattern mapping\n  - Purpose: Maintain documentation parity with tests\n  - _Leverage: Existing pattern catalog format_\n  - _Requirements: All_\n  - _Prompt: Role: Technical Writer | Task: Update pattern catalogs with edge case examples matching new tests | Success: Catalogs updated with all edge cases documented_\n",
  "fileStats": {
    "size": 10761,
    "lines": 184,
    "lastModified": "2026-01-20T13:33:29.270Z"
  },
  "comments": []
}