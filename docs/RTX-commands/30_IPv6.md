# 第30章: IPv6

> 元PDFページ: 479-516

---

第 30 章
IPv6
30.1 共通の設定
30.1.1 IPv6 パケットを扱うか否かの設定
[書式 ]
ipv6 routing  routing
no ipv6 routing  [routing ]
[設定値及び初期値 ]
•routing
• [設定値 ] :
設定値 説明
on 処理対象として扱う
off 処理対象として扱わない
• [初期値 ] : on
[説明 ]
IPv6 パケットをルーティングするか否かを設定する。本スイッチを  on にしないと  PP 側の  IPv6 関連は一切動作し
ない。
off の場合でも  TELNET による設定や  TFTP によるアクセス、 PING 等は可能。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.1.2 IPv6 インタフェースのリンク  MTU の設定
[書式 ]
ipv6 interface  mtu mtu0
ipv6 pp mtu mtu1
ipv6 tunnel  mtu mtu2
no ipv6 interface  mtu [mtu0 ]
no ipv6 pp mtu [mtu1 ]
no ipv6 tunnel  mtu [mtu2 ]
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•mtu
• [設定値 ] : MTU の値  (1280..1500 ；RTX5000 、RTX3500 の LAN インタフェースは  1280..9578 、RTX3510 、RTX1300
の LAN インターフェースは  1280..10218)
• [初期値 ] :
• mtu0=1500
• mtu1=1500
• mtu2=1280
[説明 ]
IPv6 インタフェースの  MTU の値を設定するコマンドリファレンス  | IPv6 | 479

[ノート ]
ipv6 tunnel mtu コマンドは  RTX5000 / RTX3500 Rev.14.00.29 以降、 RTX1210 Rev.14.01.34 以降、 RTX830 Rev.15.02.10
以降、および  Rev.15.04 系以降で使用可能。
L2TP 接続ではトンネルインターフェースや  PP インターフェースの  MTU 設定は無視してカプセル化し、送信する
物理インターフェースの  MTU 設定に従ってカプセル化後のパケットをフラグメントする。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.1.3 TCP セッションの  MSS 制限の設定
[書式 ]
ipv6 interface  tcp mss limit  mss
ipv6 pp tcp mss limit  mss
ipv6 tunnel  tcp mss limit  mss
no ipv6 interface  tcp mss limit  [mss]
no ipv6 pp tcp mss limit  [mss]
no ipv6 tunnel  tcp mss limit  [mss]
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•mss
• [設定値 ] :
設定値 説明
536..1440 MSS の最大長
auto 自動設定
off 設定しない
• [初期値 ] :
• off ( RTX5000 、RTX3500 、RTX1210 Rev.14.01.25 以前、 RTX830 Rev.15.02.02 以前  )
• auto ( 上記以外  )
[説明 ]
インタフェースを通過する  TCP セッションの  MSS を制限する。インタフェースを通過する  TCP パケットを監視
し、 MSS オプションの値が設定値を越えている場合には、設定値に書き換える。キーワード  auto を指定した場合に
は、インタフェースの  MTU、もしくは  PP インタフェースの場合で相手の  MRU 値が分かる場合にはその  MRU 値か
ら計算した値に書き換える。
[ノート ]
PPPoE 用の  PP インタフェースに対しては、 pppoe tcp mss limit  コマンドでも  TCP セッションの  MSS を制限するこ
とができる。このコマンドと pppoe tcp mss limit  コマンドの両方が有効な場合は、 MSS はどちらかより小さな方の
値に制限される。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.1.4 TCP ウィンドウ・スケール・オプション  を変更する
[書式 ]
ipv6 interface  tcp window-scale  sw
ipv6 pp tcp window-scale  sw
ipv6 tunnel  tcp window-scale  sw
no ipv6 interface  tcp window-scale  [...]
no ipv6 pp tcp window-scale  [...]480 | コマンドリファレンス  | IPv6

no ipv6 tunnel  tcp window-scale  [...]
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•sw
• [設定値 ] :
設定値 説明
off 何もしない
remove TCP ウィンドウ・スケール・オプション  を削除する
• [初期値 ] : off
[説明 ]
インターフェースを通過する  TCP パケットのウィンドウ・スケール・オプションを強制的に変更する。
remove を指定すると、ウィンドウ・スケール・オプション  が有効になっていた場合には、無効にして転送する。
[ノート ]
RTX5000 、RTX3500 は Rev.14.00.21 以降で使用可能。
RTX1210 は Rev.14.01.16 以降で使用可能。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.1.5 タイプ  0 のルーティングヘッダ付き  IPv6 パケットを破棄するか否かの設定
[書式 ]
ipv6 rh0 discard  switch
no ipv6 rh0 discard
[設定値及び初期値 ]
•switch
• [設定値 ] :
設定値 説明
on 破棄する
off 破棄しない
• [初期値 ] : on
[説明 ]
タイプ  0 のルーティングヘッダ付き  IPv6 パケットを破棄するか否かを選択する。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.1.6 IPv6 ファストパス機能の設定
[書式 ]
ipv6 routing  process  process
no ipv6 routing  process
[設定値及び初期値 ]
•process
• [設定値 ] :コマンドリファレンス  | IPv6 | 481

設定値 説明
fast ファストパス機能を利用する
normal ファストパス機能を利用せず、すべての  IPv6 パケッ
トをノーマルパスで処理する
• [初期値 ] : fast
[説明 ]
IPv6 パケットの転送をファストパス機能で処理するか、ノーマルパス機能で処理するかを設定する。
[ノート ]
ファストパスでは使用できる機能に制限は無いが、取り扱うパケットの種類によってはファストパスで処理されず、
ノーマルパスで処理されることもある。
本コマンドで  fast を設定した場合、 IPv6 マルチキャストパケットもファストパス機能で処理される。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.1.7 ICMPv6 でアドレス解決が完了するまでに送信を保留しておくことのできるパケット数の設定
[書式 ]
ipv6 interface  icmp-nd  queue  length  len
no ipv6 interface  icmp-nd  queue  length  [len]
[設定値及び初期値 ]
•interface
• [設定値 ] : LANインターフェース名
• [初期値 ] : -
•len
• [設定値 ] : キュー長  (0..10000)
• [初期値 ] : 200
[説明 ]
ICMPv6のNeighbor Discovery のアドレス解決が完了していないホストに対してパケットを送信しようとした時に、
アドレス解決が完了するかタイムアウトにより解決できないことが確定するまで、インターフェース毎に送信を保
留しておくことのできるパケットの最大数を設定する。
[ノート ]
RTX5000 は Rev.14.00.26 以降、 RTX3500 は Rev.14.00.26 以降、 RTX1210 は Rev.14.01.33 以降、 RTX830 は Rev.15.02.09
以降で使用可能。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.1.8 近隣キャッシュの最大エントリー数の設定
[書式 ]
ipv6 interface  neighbor  cache  max entry  num
no ipv6 interface  neighbor  cache  max entry  [num]
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•num
• [設定値 ] : 最大エントリー数  (256…20480)
• [初期値 ] :
• 1024482 | コマンドリファレンス  | IPv6

[説明 ]
インターフェースごとに近隣キャッシュの最大エントリー数を設定する。
近隣キャッシュのエントリー数が、設定した最大エントリー数に達した場合は、古い近隣キャッシュを削除する。
本コマンド実行時、現在の近隣キャッシュのエントリー数が最大エントリー数を超える場合は、古い近隣キャッシ
ュを削除する。
[ノート ]
RTX5000 、RTX3500 は Rev.14.00.32 以降で使用可能。
RTX1210 は Rev.14.01.40 以降で使用可能。
RTX830 は Rev.15.02.20 以降で使用可能。
[適用モデル ]
vRX VMware ESXi 版, vRX さくらのクラウド版 , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210,
RTX840, RTX830
30.1.9 IPv6 のフラグメントパケットを再構成するために保持しておく時間を設定
[書式 ]
ipv6 reassembly  hold-time  sec
no ipv6 reassembly  hold-time  [sec]
[設定値及び初期値 ]
•sec
• [設定値 ] :
設定値 説明
秒数  ( 1 .. 60 ) フラグメントパケットを再構成するために保持して
おく時間
• [初期値 ] : 60 秒
[説明 ]
IPv6 のフラグメントパケットを再構成するために保持しておく時間。
設定した時間が経過しても再構成ができなかった場合、保持していたパケットは破棄される。
コマンド実行時にすでに保持していたパケットについては変更しない。
[ノート ]
RTX5000 、RTX3500 は Rev.14.00.32 以降で使用可能。
RTX1210 は Rev.14.01.40 以降で使用可能。
RTX830 は Rev.15.02.20 以降で使用可能。
[適用モデル ]
vRX VMware ESXi 版, vRX さくらのクラウド版 , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210,
RTX840, RTX830
30.1.10 IPv6 パケットの  DS フィールドの書き換えの設定
[書式 ]
ipv6 dscp  supersede  id dscp filter_num  [filter_num_list ]
no ipv6 dscp  supersede  id [dscp]
[設定値及び初期値 ]
•id
• [設定値 ] : 識別番号  (1..65535)
• [初期値 ] : -
•dscp
• [設定値 ] :コマンドリファレンス  | IPv6 | 483

•書き換える  DSCP 値 (0..63)
•以下のニーモニックが利用できる
ニーモニック DSCP 値
default 0
cs1 8
cs2 16
cs3 24
cs4 32
cs5 40
cs6 48
cs7 56
af11 10
af12 12
af13 14
af21 18
af22 20
af23 22
af31 26
af32 28
af33 30
af41 34
af42 36
af43 38
ef 46
• [初期値 ] : -
•filter_num
• [設定値 ] : 静的フィルターの番号  (1..21474836)
• [初期値 ] : -
•filter_num_list
• [設定値 ] : 静的フィルターの番号  (1..21474836) の並び
• [初期値 ] : -
[説明 ]
IPv6 パケットを中継する場合に  DS フィールドを指定した値に書き換える。
識別番号順にリストをチェックし、 filter_num  リストのフィルターを順次適用していく。そして、最初にマッチした
IPv6 フィルターが  pass、pass-log、pass-nolog 、restrict、restrict-log 、restrict-nolog のいずれかであれば  DS フィールド
が書き換えられる。
reject、reject-log または  reject-nolog である場合は書き換えずに処理を終わる。
[ノート ]
RTX5000 、RTX3500 は Rev.14.00.34 以降で使用可能。
RTX1300 は Rev.23.00.05 以降で使用可能。
RTX1220 は Rev.15.04.05 以降で使用可能。
RTX1210 は Rev.14.01.42 以降で使用可能。
RTX830 は Rev.15.02.27 以降で使用可能。484 | コマンドリファレンス  | IPv6

[適用モデル ]
RTX3510, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.2 IPv6 アドレスの管理
30.2.1 DHCPv6 で動的に割り当てるプレフィックスの定義
[書式 ]
ipv6 dhcp  prefix  prefix_id  dhcp-prefix @prefix_interface [sub_prefix /prefix_len ]
no ipv6 dhcp  prefix  prefix_id
[設定値及び初期値 ]
•prefix_id
• [設定値 ] : プレフィックス番号
• [初期値 ] : -
•prefix_interface
• [設定値 ] : DHCPv6 プロキシの転送元のインターフェース名
• [初期値 ] : -
•sub_prefix
• [設定値 ] : prefix_interface  より取得したプレフィックスを分割する際に指定する下位部分
• [初期値 ] : -
•prefix_len
• [設定値 ] : プレフィックス長
• [初期値 ] : -
[説明 ]
DHCPv6 で動的に割り当てるプレフィックスの定義する。実際に割り当てを行うには、 ipv6 interface  dhcp service  コ
マンドの  prefix オプションの設定が必要である。
prefix_interface  には  LOOPBACK インタフェースは指定できない。
[ノート ]
RTX1300 Rev.23.00.16 以降で指定可能。
[適用モデル ]
RTX1300
30.2.2 インタフェースの  IPv6 アドレスの設定
[書式 ]
ipv6 interface  address  ipv6_address /prefix_len  [address_type ]
ipv6 interface  address  auto
ipv6 interface  address  dhcp
ipv6 interface  address  proxy
ipv6 pp address  ipv6_address /prefix_len  [address_type ]
ipv6 pp address  auto
ipv6 pp address  dhcp
ipv6 pp address  proxy
ipv6 tunnel  address  ipv6_address /prefix_len  [address_type ]
ipv6 tunnel  address  auto
ipv6 tunnel  address  dhcp
ipv6 tunnel  address  proxy
no ipv6 interface  address  ipv6_address /prefix_len  [address_type ]
no ipv6 interface  address  auto
no ipv6 interface  address  dhcp
no ipv6 interface  address  proxy
no ipv6 pp address  ipv6_address /prefix_len  [address_type ]コマンドリファレンス  | IPv6 | 485

no ipv6 pp address  auto
no ipv6 pp address  dhcp
no ipv6 pp address  proxy
no ipv6 tunnel  address  ipv6_address /prefix_len  [address_type ]
no ipv6 tunnel  address  auto
no ipv6 tunnel  address  dhcp
no ipv6 tunnel  address  proxy
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名、 LOOPBACK インタフェース名、ブリッジインタフェース名
• [初期値 ] : -
•ipv6_address
• [設定値 ] : IPv6 アドレス部分
• [初期値 ] : -
•prefix_len
• [設定値 ] : IPv6 プレフィックス長
• [初期値 ] : -
•address_type
• [設定値 ] :
設定値 説明
unicast ユニキャスト
anycast エニーキャスト
• [初期値 ] : unicast
• auto : RA で取得したプレフィックスとインタフェースの MACアドレスから IPv6アドレスを生成することを示
すキーワード
• [初期値 ] : -
• dhcp : DHCPv6 で取得したプレフィックスとインタフェースの MACアドレスから IPv6アドレスを生成すること
を示すキーワード
• [初期値 ] : -
•proxy  : プロキシ
• [設定値 ] :
•prefix_type @prefix_interface [interface_id /prefix_len ]
•prefix_type
設定値 説明
dhcp-prefix DHCPv6 プロキシ
ra-prefix RAプロキシ
•prefix_interface
設定値 説明
prefix_interface 転送元のインタフェース名
•interface_id
設定値 説明
interface_id インタフェース ID
•prefix_len
設定値 説明
prefix_len IPv6 プレフィックス長
• [初期値 ] : -486 | コマンドリファレンス  | IPv6

[説明 ]
インタフェースに  IPv6 アドレスを付与する。
[ノート ]
このコマンドで付与したアドレスは、 show ipv6 address  コマンドで確認することができる。
複数の  LAN インタフェースでアドレスを自動で設定する機能を利用することができる。
具体的には、 RAで取得したプレフィックスとインタフェース IDから IPv6アドレスを生成する機能と、 DHCPv6 で
取得したプレフィックスとインタフェース IDから IPv6アドレスを生成する機能が利用できる。
これらを設定する場合、デフォルト経路は最後に設定が完了したインタフェースに向く。
LOOPBACK インタフェースを指定した場合は、 auto、dhcp、address_type 、proxy  は指定できない。
prefix_interface  には  LOOPBACK インタフェースは指定できない。
ブリッジインタフェースは、 vRX Amazon EC2 版、および  RTX5000 / RTX3500 Rev.14.00.11 以前では指定不可能。
[設定例 ]
• LAN2 で受信した RAのプレフィックスに ::1を付け足して IPv6アドレスを作り、それを  LAN1 に付与する
# ipv6 lan1 address ra-prefix@lan2::1/64
• LAN2 が DHCPv6 で取得した  /56 のプレフィックス  ( XXXX:XXXX:XXXX:XX00::/56 ) を分割し、 LAN1 と LAN3
に異なる  /64 のプレフィックスの  IPv6アドレスを付与する
LAN1 に付与する  IPv6アドレス  : XXXX:XXXX:XXXX:XX01::1/64
LAN3 に付与する  IPv6アドレス  : XXXX:XXXX:XXXX:XX02::1/64
# ipv6 lan1 address dhcp-prefix@lan2::1:0:0:0:1/64
# ipv6 lan3 address dhcp-prefix@lan2::2:0:0:0:1/64
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.2.3 インタフェースのプレフィックスに基づく  IPv6 アドレスの設定
[書式 ]
ipv6 interface  prefix  ipv6_prefix /prefix_len
ipv6 interface  prefix  proxy
ipv6 pp prefix  ipv6_prefix /prefix_len
ipv6 pp prefix  proxy
ipv6 tunnel  prefix  ipv6_prefix /prefix_len
ipv6 tunnel  prefix  proxy
no ipv6 interface  prefix  ipv6_prefix /prefix_len
no ipv6 interface  prefix  proxy
no ipv6 pp prefix  ipv6_prefix /prefix_len
no ipv6 pp prefix  proxy
no ipv6 tunnel  prefix  ipv6_prefix /prefix_len
no ipv6 tunnel  prefix  proxy
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名、ブリッジインタフェース名
• [初期値 ] : -
•ipv6_prefix
• [設定値 ] : IPv6 プレフィックスのアドレス部分
• [初期値 ] : -
•prefix_len
• [設定値 ] : IPv6 プレフィックス長
• [初期値 ] : -
•proxy  : プロキシ
• [設定値 ] :
•prefix_type @prefix_interface [interface_id /prefix_len ]コマンドリファレンス  | IPv6 | 487

•prefix_type
設定値 説明
dhcp-prefix DHCPv6 プロキシ
ra-prefix RAプロキシ
•prefix_interface
設定値 説明
prefix_interface 転送元のインタフェース名
•interface_id
設定値 説明
interface_id インタフェース ID
•prefix_len
設定値 説明
prefix_len IPv6 プレフィックス長
• [初期値 ] : -
[説明 ]
インタフェースに  IPv6 アドレスを付与する。類似のコマンドに ipv6 interface  address  コマンドがあるが、このコマ
ンドではアドレスではなくプレフィックスのみを指定する。プレフィックス以降の部分は  MAC アドレスに基づい
て自動的に補完する。このときに使用する  MAC アドレスは、 設定しようとするインタフェースに割り当てられてい
るものが使われる。ただし、 MAC アドレスを持たない  PP インタフェースやトンネルインタフェースでは  LAN1 イ
ンタフェースの  MAC アドレスを使用する。
なお、 類似の名前を持つ ipv6 prefix  コマンドはルーター広告で通知するプレフィックスを定義するものであり、 IPv6
アドレスを付与するものではない。しかしながら、通常の運用では、インタフェースに付与する  IPv6 アドレスのプ
レフィックスとルーター広告で通知するプレフィックスは同じであるから、双方のコマンドに同じプレ  フィックス
を設定することが多い。
[ノート ]
このコマンドで付与したアドレスは、 show ipv6 address  コマンドで確認することができる。
prefix_interface  には  LOOPBACK インタフェースは指定できない。
ブリッジインタフェースは、 vRX Amazon EC2 版、および  RTX5000 / RTX3500 Rev.14.00.11 以前では指定不可能。
[設定例 ]
• LAN2 で受信した RAのプレフィックスを  LAN1 に付与する
# ipv6 lan1 prefix ra-prefix@lan2::/64
• LAN2 が DHCPv6 で取得した  /56 のプレフィックス  ( XXXX:XXXX:XXXX:XX00::/56 ) を分割し、 LAN1 と LAN3
に異なる  /64 のプレフィックスを付与する
LAN1 に付与するプレフィックス  : XXXX:XXXX:XXXX:XX01::/64
LAN3 に付与するプレフィックス  : XXXX:XXXX:XXXX:XX02::/64
# ipv6 lan1 prefix dhcp-prefix@lan2::1:0:0:0:1/64
# ipv6 lan3 prefix dhcp-prefix@lan2::2:0:0:0:1/64
( 注：内部動作の関係上「 dhcp-prefix@lan2::1:0:0:0:0/64 」ではなく、 「 dhcp-
prefix@lan2::1:0:0:0:1/64 」と設定してください。  )
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.2.4 IPv6 プレフィックスに変化があった時にログに記録するか否かの設定
[書式 ]
ipv6 interface  prefix  change  log log
ipv6 pp prefix  change  log log488 | コマンドリファレンス  | IPv6

ipv6 tunnel  prefix  change  log log
no ipv6 interface  prefix  change  log log
no ipv6 pp prefix  change  log log
no ipv6 tunnel  prefix  change  log log
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名、ブリッジインタフェース名
• [初期値 ] : -
•log
• [設定値 ] :
設定値 説明
on IPv6 プレフィックスの変化をログに記録する
off IPv6 プレフィックスの変化をログに記録しない
• [初期値 ] : off
[説明 ]
IPv6 プレフィックスに変化があった時にそれをログに記録するか否かを設定する。
ログは  INFO レベルで記録される。
同じプレフィックスに対するアドレスを複数設定した場合、同じログが複数回表示される。
[ノート ]
ブリッジインタフェースは、 vRX Amazon EC2 版、および  RTX5000 / RTX3500 Rev.14.00.11 以前では指定不可能。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.2.5 DHCPv6 の動作の設定
[書式 ]
ipv6 interface  dhcp  service  type
ipv6 interface  dhcp  service  client [ir= value ]
ipv6 interface  dhcp  service  server [prefix= prefix_id ]
ipv6 pp dhcp  service  type
ipv6 pp dhcp  service  client [ir= value ]
ipv6 tunnel  dhcp  service  type
ipv6 tunnel  dhcp  service  client [ir= value ]
no ipv6 interface  dhcp  service
no ipv6 pp dhcp  service
no ipv6 tunnel  dhcp  service
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•type
• [設定値 ] :
設定値 説明
off DHCPv6 を使わない
client クライアント
server サーバー
• [初期値 ] : offコマンドリファレンス  | IPv6 | 489

•value
• [設定値 ] :
設定値 説明
on クライアントとして動作する時、 Inform-Request を送
信する
off クライアントとして動作する時、 Solicitを送信する
• [初期値 ] : off
•prefix_id
• [設定値 ] : プレフィックス番号
• [初期値 ] : -
[説明 ]
各インタフェースにおける DHCPv6 の動作を設定する。
サーバーとして動作する場合、常に Inform-Request に対応する。また、 prefix オプションを設定した場合、 Solicitに
対応し  ipv6 dhcp prefix  コマンドで設定されたプレフックスを割り当てる。
[ノート ]
ir オプションは、 vRX Amazon EC2 版 では指定不可能。
prefix オプションは、 RTX1300 Rev.23.00.16 以降で指定可能。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.2.6 DAD(Duplicate Address Detection) の送信回数の設定
[書式 ]
ipv6 interface  dad retry  count  count
ipv6 pp dad retry  count  count
no ipv6 interface  dad retry  count  [count ]
no ipv6 pp dad retry  count  [count ]
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名、ブリッジインタフェース名
• [初期値 ] : -
•count
• [設定値 ] : 選択したインタフェースでの  DAD の再送回数  (0..10)
• [初期値 ] : 1
[説明 ]
インタフェースに  IPv6 アドレスが設定されたときに、アドレスの重複を検出するために送信する  DAD の送信回数
を設定する。ただし、 0 を設定した場合は、 DAD を送信せずにアドレスを有効なものとして扱う。
[ノート ]
ブリッジインタフェースは、 vRX Amazon EC2 版、および  RTX5000 / RTX3500 Rev.14.00.11 以前では指定不可能。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.2.7 自動的に設定される  IPv6 アドレスの最大数の設定
[書式 ]
ipv6 max auto  address  max
no ipv6 max auto  address  [max]490 | コマンドリファレンス  | IPv6

[設定値及び初期値 ]
•max
• [設定値 ] : 自動的に設定される  IPv6 アドレスの  1 インタフェースあたりの最大数  (1～256)
• [初期値 ] : 16
[説明 ]
RA によりインタフェースに自動的に設定される  IPv6 アドレスの  1 インタフェースあたりの最大数を設定する。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.2.8 始点  IPv6 アドレスを選択する規則の設定
[書式 ]
ipv6 source  address  selection  rule rule
no ipv6 source  address  selection  rule [rule]
[設定値及び初期値 ]
•rule : 始点  IPv6 アドレスを選択する規則
• [設定値 ] :
設定値 説明
prefix プレフィックスの最長一致
lifetime 寿命の長い方を優先
• [初期値 ] : prefix
[説明 ]
始点  IPv6 アドレスを選択する規則を設定する。
'prefix' を設定した場合には、終点  IPv6 アドレスと始点  IPv6 アドレス候補とを比較して、先頭から一致している部分
( プレフィックス  ) がもっとも長いものを始点アドレスとして選択する。
'lifetime' を設定した場合には、 IPv6 アドレスの寿命が長いものを優先して選択する。
[ノート ]
通常は  'prefix' を設定しておけばよいが、アドレスリナンバリングが発生するときには、 'lifetime' の設定が有効な場
合がある。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.3 近隣探索
30.3.1 ルーター広告で配布するプレフィックスの定義
[書式 ]
ipv6 prefix  prefix_id  prefix /prefix_len  [preferred_lifetime= time] [valid_lifetime= time] [l_flag= switch ] [a_flag= switch ]
ipv6 prefix  prefix_id  proxy  [preferred_lifetime= time] [valid_lifetime= time] [l_flag= switch ] [a_flag= switch ]
no ipv6 prefix  prefix_id
[設定値及び初期値 ]
•prefix_id
• [設定値 ] : プレフィックス番号
• [初期値 ] : -
•prefix
• [設定値 ] : プレフィックス
• [初期値 ] : -
•prefix_len
• [設定値 ] : プレフィックス長コマンドリファレンス  | IPv6 | 491

• [初期値 ] : -
•proxy  : プロキシ
• [設定値 ] :
•prefix_type @prefix_interface [interface_id /prefix_len ]
•prefix_type
設定値 説明
dhcp-prefix DHCPv6 プロキシ
ra-prefix RAプロキシ
•prefix_interface
設定値 説明
prefix_interface 転送元のインタフェース名
•interface_id
設定値 説明
interface_id インタフェース ID
•prefix_len
設定値 説明
prefix_len IPv6 プレフィックス長
• [初期値 ] : -
• preferred_lifetime : プレフィックスの推奨寿命  ( 0..4294967295 )
• [初期値 ] : 604800
• valid_lifetime : プレフィックスの有効寿命  ( 0..4294967295 )
• [初期値 ] : 2592000
•time : 時間設定
• [設定値 ] :
• yyyy-mm-dd[,hh:mm[:ss]]
設定値 説明
yyyy 年 (1980..2079)
mm 月 (01..12)
dd 日 (01..31)
hh 時 (00..23)
mm 分 (00..59)
ss 秒 (00..59、省略時は  00)
• [初期値 ] : -
• l_flag : on-link フラグ
• [初期値 ] : on
• a_flag : autonomous address configuration フラグ
• [初期値 ] : on
•switch
• [設定値 ] :
• on
• off
• [初期値 ] : -
[説明 ]
ルーター広告で配布するプレフィックスを定義する。実際に広告するためには、 ipv6 interface  rtadv send  コマンドの492 | コマンドリファレンス  | IPv6

設定が必要である。
time では寿命を秒数または寿命が尽きる時刻のいずれかを設定できる。 time として数値  ( 0 以上  4294967295 以下  )
を設定すると、その秒数を寿命として広告する。 time として時刻を設定すると、その時刻に寿命が尽きるものとし
て寿命を計算し、広告する。時刻を設定する場合は、上記のフォーマットに従う。有効寿命とはアドレスが無効に
なるまでの時間であり、推奨寿命とはアドレスを新たな接続での使用が不可となる時間である。また、 on-link フラ
グはプレフィックスがそのデータリンクに固有である時に  on とする。 autonomous address configuration フラグはプ
レフィックスを自律アドレス設定で使うことができる場合に  on とする。
prefix_interface  には  LOOPBACK インタフェースは指定できない。
ブリッジインタフェースは、 vRX Amazon EC2 版、および  RTX5000 / RTX3500 Rev.14.00.11 以前では指定不可能。
[ノート ]
リンクローカルのプレフィックスを設定することはできない。
[設定例 ]
• LAN2 で受信した RAを LAN1 に転送する
# ipv6 prefix 1 ra-prefix@lan2::/64
# ipv6 lan1 rtadv send 1
• LAN2 が DHCPv6 で取得した  /56 のプレフィックス  ( XXXX:XXXX:XXXX:XX00::/56 ) を分割し、 LAN1 と LAN3
から異なる  /64 のプレフィックスをルーター広告で配布する
LAN1 のルーター広告で配布するプレフィックス  : XXXX:XXXX:XXXX:XX01::/64
LAN3 のルーター広告で配布するプレフィックス  : XXXX:XXXX:XXXX:XX02::/64
# ipv6 prefix 1 dhcp-prefix@lan2::1:0:0:0:1/64
# ipv6 prefix 2 dhcp-prefix@lan2::2:0:0:0:1/64
# ipv6 lan1 rtadv send 1
# ipv6 lan3 rtadv send 2
( 注：内部動作の関係上「 dhcp-prefix@lan2::1:0:0:0:0/64 」ではなく、 「 dhcp-
prefix@lan2::1:0:0:0:1/64 」と設定してください。  )
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.3.2 ルーター広告で配布する  RDNSS オプションの定義
[書式 ]
ipv6 nd ra-rdnss  rdnss_id  dns_ipv6_address  [dns_ipv6_address ...] [option =value ]
no ipv6 nd ra-rdnss  rdnss_id  [...]
[設定値及び初期値 ]
•rdnss_id
• [設定値 ] : RDNSS オプション番号  (1..21474836)
• [初期値 ] : -
•dns_ipv6_address
• [設定値 ] :
設定値 説明
dhcpv6 DHCPv6 で通知された  DNS サーバーの  IPv6 アドレ
ス
ipv6_address 任意の  DNS サーバーの  IPv6 アドレス
• [初期値 ] : -
•option=value  : NAME=V ALUE の列
• [設定値 ] :
NAME V ALUE 説明
lifetime 秒数、 infinityDNS サーバーの有効時間
(0..4294967294 秒 )。infinity は
DNS サーバーを無期限で使用でき
ることを示す。コマンドリファレンス  | IPv6 | 493

• [初期値 ] :
• lifetime = ipv6 interface  rtadv send  コマンドのルーター広告を送信する最大間隔  ( max-rtr-adv-interval ) の 3
倍
[説明 ]
ルーター広告で配布する  RDNSS オプションを定義する。実際に広告するためには、 ipv6 interface  rtadv send  コマン
ドの  rdnss= オプションの設定が必要である。
dns_ipv6_address  は最大  3 つまで指定可能。
[ノート ]
RTX1210 Rev.14.01.41 以降、 RTX830 Rev.15.02.24 以降、 RTX1220 Rev.15.04.04 以降、 RTX1300 Rev.23.00.05 以降のフ
ァームウェアで使用可能。
[適用モデル ]
RTX3510, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.3.3 ルーター広告の送信の制御
[書式 ]
ipv6 interface  rtadv  send  prefix_id  [prefix_id ...] [option =value ...]
ipv6 pp rtadv  send  prefix_id  [prefix_id ...] [option =value ...]
no ipv6 interface  rtadv  send  [...]
no ipv6 pp rtadv  send  [...]
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•prefix_id
• [設定値 ] : プレフィックス番号
• [初期値 ] : -
•option=value  : NAME=V ALUE の列
• [設定値 ] :
NAME V ALUE 説明
m_flag on、offmanaged address configuration フラ
グ。ルーター広告による自動設定
とは別に、 DHCP6 に代表されるル
ーター広告以外の手段によるアド
レス自動設定をホストに許可させ
るか否かの設定。
o_flag on、offother stateful configuration フラグ。
ルーター広告以外の手段により
IPv6 アドレス以外のオプション情
報をホストに自動的に取得させる
か否かの設定。
prf_flag high、medium、lowdefault router preference フラグ。ル
ーター広告の優先度を示す設定。
max-rtr-adv-interval 秒数ルーター広告を送信する最大間隔
(4-1,800 秒 )
min-rtr-adv-interval 秒数ルーター広告を送信する最小間隔
(3-1,350 秒 )
adv-default-lifetime 秒数ルーター広告によって設定される
端末のデフォルト経路の有効時間
(0-9,000 秒 )494 | コマンドリファレンス  | IPv6

NAME V ALUE 説明
adv-reachable-time ミリ秒数ルーター広告を受信した端末が、
ノード間で確認した到達性の有効
時間  (0-3,600,000 ミリ秒  )
adv-retrans-time ミリ秒数ルーター広告を再送する間隔
(0-4,294,967,295 ミリ秒  )
adv-cur-hop-limit ホップ数ルーター広告の限界ホップ数
(0-255)
mtu auto、off、バイト数ルーター広告に  MTU オプション
を含めるか否かと、含める場合の
値の設定。 auto の場合はインタフ
ェースの  MTU を採用する。
route-inforoute-info 、off、経路情報オプショ
ン番号ルーター広告に経路情報オプショ
ンを含めるか否かと、含める場合
の値の設定。 route-info の場合は
RAの経路情報オプションで割り
当てられた経路情報を通知する。
rdnssrdnss、off、dhcpv6、RDNSSオプシ
ョン番号ルーター広告に  RDNSS オプショ
ンを含めるか否かと、含める場合
の値の設定。 rdnss の場合は RAの
RDNSSオプションで割り当てられ
たサーバー群を通知する。
dnssl dnssl、off、DNSSL オプション番号ルーター広告に  dnssl オプション
を含めるか否かと、含める場合の
値の設定。 dnssl の場合は RAの
DNSSLオプションで割り当てられ
たサーバー群を通知する。
• [初期値 ] :
• m_flag = off
• o_flag = off
• prf_flag = medium
• max-rtr-adv-interval = 600
• min-rtr-adv-interval = 200
• adv-default-lifetime = 1800
• adv-reachable-time = 0
• adv-retrans-time = 0
• adv-cur-hop-limit = 64
• mtu=auto
• route-info = route-info
• rdnss=rdnss
• dnssl=dnssl
[説明 ]
インタフェースごとにルーター広告の送信を制御する。送信されるプレフィックスとして、 ipv6 prefix  コマンドで
設定されたものが用いられる。また、オプションとして  m_flag および  o_flag を利用して、管理するホストがルータ
ー広告以外の自動設定情報をどのように解釈するかを設定することができる。オプションでは、送信するルーター
広告の送信間隔や、ルーター広告に含まれる情報の設定を行うこともできる。
[ノート ]
prf_flag= オプションは、 vRX Amazon EC2 版、vRX VMware ESXi 版、RTX5000 / RTX3500 Rev.14.00.31 以前、 RTX1300
Rev.23.00.04 以前、 RTX1220 Rev.15.04.03 以前、 RTX1210 Rev.14.01.40 以前、および  RTX830 Rev.15.02.21 以前では指
定不可能。
route-info= オプションは、 vRX Amazon EC2 版、 vRX VMware ESXi 版、 RTX5000 / RTX3500 、RTX3510 Rev.23.01.01
以前、 RTX1300 Rev.23.00.11 以前、 RTX1220 Rev.15.04.05 以前、 RTX1210 、および  RTX830 Rev.15.02.30 以前では指
定不可能。
rdnss= オプションは、 vRX Amazon EC2 版、 vRX VMware ESXi 版、 RTX5000 / RTX3500 Rev.14.00.31 以前、 RTX1210
Rev.14.01.39 以前、および  RTX830 Rev.15.02.19 以前では指定不可能。 RDNSSオプション番号は、 RTX5000 、コマンドリファレンス  | IPv6 | 495

RTX3500 、RTX1300 Rev.23.00.04 以前、 RTX1220 Rev.15.04.03 以前、 RTX1210 Rev.14.01.40 以前、および  RTX830
Rev.15.02.23 以前では指定不可能。
dnssl= オプションは、 vRX Amazon EC2 版、 vRX VMware ESXi 版、 RTX5000 、RTX3510 Rev.23.01.01 以前、
RTX3500 、RTX1300 Rev.23.00.11 以前、 RTX1220 Rev.15.04.05 以前、 RTX1210 、および  RTX830 Rev.15.02.29 以前では
指定不可能。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.3.4 ルーター要請の再送機能の設定
[書式 ]
ipv6 interface  rtsol  max-retransmit  mrt=MRT  mrd=MRD  mrc=MRC
ipv6 pp rtsol  max-retransmit  mrt=MRT  mrd=MRD  mrc=MRC
no ipv6 interface  rtsol  max-retransmit  [...]
no ipv6 pp rtsol  max-retransmit  [...]
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•MRT
• [設定値 ] : 最大再送間隔 (4..3600(秒))
• [初期値 ] : 3600
•MRD
• [設定値 ] : 最大再送継続時間 (4..2147483647( 秒)または infinity)
• [初期値 ] : infinity
•MRC
• [設定値 ] : 最大再送回数 (0..2147483647 または infinity)
• [初期値 ] : infinity
[説明 ]
再送間隔は初期値 4秒から 2倍ずつ増加していく。初期値は +10%幅、倍率は ±10%幅でランダムな値を取る。
MRDとMRCの両方を infinity以外に設定している場合は、 MRDとMRCのどちらかの条件が満たされたら再送は
ストップする。
MRCを0に設定している場合は再送を行わない。
[ノート ]
RTX5000 は Rev.14.00.26 以降で使用可能。
RTX3500 は Rev.14.00.26 以降で使用可能。
RTX1210 は Rev.14.01.33 以降で使用可能。
RTX830 は Rev.15.02.09 以降で使用可能。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.3.5 ルーター広告で配布する  DNSSL オプションの定義
[書式 ]
ipv6 nd ra-dnssl  dnssl_id  domain_name  [domain_name ...] [option =value ]
no ipv6 nd ra-dnssl  dnssl_id  [...]
[設定値及び初期値 ]
•dnssl_id
• [設定値 ] : DNSSL オプション番号  (1..21474836)
• [初期値 ] : -
•domain_name
• [設定値 ] :496 | コマンドリファレンス  | IPv6

設定値 説明
domain_name DNSSL オプションで通知するドメイン名
• [初期値 ] : -
•option=value  : NAME=V ALUE の列
• [設定値 ] :
NAME V ALUE 説明
lifetime 秒数、 infinityDNS サーバーの有効時間
(0..4294967294 秒 )。infinity は
DNS サーバーを無期限で使用でき
ることを示す。
• [初期値 ] :
• lifetime = ipv6 interface  rtadv send  コマンドのルーター広告を送信する最大間隔  ( max-rtr-adv-interval ) の 3
倍
[説明 ]
ルーター広告で配布する  DNSSL オプションを定義する。実際に広告するためには、 ipv6 interface  rtadv send  コマン
ドの  dnssl オプションの設定が必要である。
domain_name  は最大  3 つまで指定可能。
[ノート ]
RTX3510 Rev.23.01.02 以降で指定可能。
RTX1300 Rev.23.00.12 以降で指定可能。
RTX1220 Rev.15.04.07 以降で指定可能。
RTX830 Rev.15.02.30 以降で指定可能。
[適用モデル ]
RTX3510, RTX1300, RTX1220, RTX840, RTX830
30.3.6 ルーター広告で配布する経路情報オプションの定義
[書式 ]
ipv6 nd ra-route-info  route_info_id  prefix /prefix_len  [option =value ]
no ipv6 nd ra-route-info  route_info_id  [...]
[設定値及び初期値 ]
•route_info_id
• [設定値 ] : 経路情報オプション番号  (1..21474836)
• [初期値 ] : -
•prefix
• [設定値 ] : プレフィックス
• [初期値 ] : -
•prefix_len
• [設定値 ] : プレフィックス長
• [初期値 ] : -
•option=value  : NAME=V ALUE の列
• [設定値 ] :
NAME V ALUE 説明
prf_flag high、medium、lowRoute Preference フラグ。経路の優
先度を示す設定。
lifetime 秒数、 infinity経路情報の有効時間
(0..4294967294 秒)。infinity は経路
情報を無期限で使用できることを
示す。コマンドリファレンス  | IPv6 | 497

• [初期値 ] :
• prf_flag = medium
• lifetime = ipv6 interface  rtadv send  コマンドのルーター広告を送信する最大間隔  ( max-rtr-adv-interval ) の 3
倍
[説明 ]
ルーター広告で配布する経路情報オプションを定義する。実際に広告するためには、 ipv6 interface  rtadv send  コマン
ドの  route-info オプションの設定が必要である。
[ノート ]
RTX3510 Rev.23.01.01 以前、 RTX1300 Rev.23.00.11 以前、 RTX1220 Rev.15.04.06 以前、および  RTX830 Rev.15.02.30 以
前では使用不可能。
[適用モデル ]
vRX さくらのクラウド版 , RTX3510, RTX1300, RTX1220, RTX840, RTX830
30.4 経路制御
30.4.1 IPv6 の経路情報の追加
[書式 ]
ipv6 route  network  gateway gateway  [parameter ] [gateway gateway  [parameter ]]
no ipv6 route  network  [gateway...]
[設定値及び初期値 ]
•network
• [設定値 ] :
設定値 説明
IPv6 アドレス /プレフィックス長 送り先のホスト
default デフォルト経路
• [初期値 ] : -
•gateway  : ゲートウェイ
• [設定値 ] :
• IP アドレス  % スコープ識別子
• pp peer_num  [dlci= dlci] : PP インタフェースへの経路。 "dlci=dlci" が指定された場合は、フレームリレーの
DLCI への経路
•peer_num
•相手先情報番号
• anonymous
• pp anonymous name= name
設定値 説明
name PAP/CHAP による名前
• ra interface
設定値 説明
interfaceRA にて決定されるデフォルトゲートウェイを使う
場合の、 RAクライアントとして動作する  LAN イン
タフェース名、 ブリッジインタフェース名 (送り先が
Defaultの時のみ有効 )
• dhcp interface498 | コマンドリファレンス  | IPv6

設定値 説明
interfaceDHCP にて与えられるデフォルトゲートウェイを
使う場合の、 DHCP クライアントとして動作する
LAN インタフェース名、 ブリッジインタフェース名
(送り先が Defaultの時のみ有効 )
• tunnel tunnel_num  : トンネルインタフェースへの経路
• LOOPBACK インタフェース名、 NULL インタフェース名
• [初期値 ] : -
•parameter  : 以下のパラメータを空白で区切り複数設定可能
• [設定値 ] :
設定値 説明
filter number  [number ..]フィルタ型経路の指定
•number
•フィルタの番号  (1..21474836) ( 空白で区切り
複数設定可能  )
dpi number  [number ..]フィルタ型経路の指定
•number
• DPI フィルタの番号  (1..2147483647) ( 空白で区
切り複数設定可能  )
metric metricメトリックの指定
•metric
•メトリック値  (1..15)
•省略時は  1
hide出力インタフェースが  LAN インタフェース、または
PP インタフェース、 TUNNEL インタフェースの場合
のみ有効なオプションで、 回線が接続されている場合
だけ経路が有効になることを意味する
• [初期値 ] : -
[説明 ]
IPv6 の経路情報を追加する。
LAN インタフェースが複数ある機種ではスコープ識別子でインタフェースを指定する必要がある。スコープ識別子
には  LAN インタフェース名を用いる。  LAN インタフェースがひとつである機種に関しては、スコープ識別子が省
略されると  LAN1 が指定されたものとして扱う。
gateway  のパラメーターとしてフィルタ型経路を指定した場合には、記述されている順にフィルタを適用していき、
適合したゲートウェイが選択される。  適合するゲートウェイが存在しない場合や、フィルタ型経路が指定されてい
るゲートウェイが一つも記述されていない場合には、フィルタ型経路が指定されていないゲートウェイが選択され
る。  フィルタ型経路が指定されていないゲートウェイも存在しない場合には、その経路は存在しないものとして処
理が継続される。  フィルタ型経路が指定されていないゲートウェイが複数記述された場合の経路の選択は、それら
の経路を使用する時点でラウンドロビンにより決定される。
なお  LOOPBACK インタフェース、 NULL インタフェースは常にアップ状態なので、 hide オプションは指定はできる
ものの意味はない。
[ノート ]
PP インタフェースの  dlci= オプションは、 RTX5000 、RTX3500 で指定可能。
ra interface  は、 vRX Amazon EC2 版、 vRX VMware ESXi 版、 RTX5000 、RTX3500 、RTX1300 Rev.23.00.04 以前、
RTX1220 Rev.15.04.04 以前、 RTX1210 、および  RTX830 Rev.15.02.26 以前では指定不可能。
ブリッジインタフェースは、 vRX Amazon EC2 版、および  RTX5000 / RTX3500 Rev.14.00.11 以前では指定不可能。
filter オプションは、 vRX Amazon EC2 版、 vRX VMware ESXi 版、 RTX5000 、RTX3510 Rev.23.01.01 以前、 RTX3500 、
RTX1300 Rev.23.00.11 以前、 RTX1220 Rev.15.04.05 以前、 RTX1210 、 および  RTX830 Rev.15.02.29 以前では指定不可能。
dpi オプションは、 RTX1300 Rev.23.00.12 以降および  RTX830 Rev.15.02.30 以降で指定可能。
[拡張ライセンス対応 ]
拡張ライセンス をインポートすると、以下のパラメーターに入力できる上限値が拡張される。コマンドリファレンス  | IPv6 | 499

•tunnel_num
ライセンス名拡張後の上限値
( ライセンス本数ごとの値  )
1本 2本 3本 4本 5本
YSL-VPN-EX1 100 - - - -
YSL-VPN-EX2 300 500 700 900 1100
YSL-VPN-EX3 1500 2000 2500 3000 -
•peer_num
ライセンス名拡張後の上限値
( ライセンス本数ごとの値  )
1本 2本 3本 4本 5本
YSL-VPN-EX1 100 - - - -
YSL-VPN-EX2 150
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.4.2 IPv6 の経路情報に変化があった時にログに記録するか否かの設定
[書式 ]
ipv6 route  change  log log
no ipv6 route  change  log [log]
[設定値及び初期値 ]
•log
• [設定値 ] :
設定値 説明
on IPv6 経路の変化をログに記録する
off IPv6 経路の変化をログに記録しない
• [初期値 ] : off
[説明 ]
IPv6 の経路情報に変化があった時にそれをログに記録するか否かを設定する。
ログは  INFO レベルで記録される。
[ノート ]
RTX1300 Rev.23.00.04 以前、 RTX1220 Rev.15.04.03 以前、および  RTX830 Rev.15.02.26 以前では使用不可能。
[適用モデル ]
vRX さくらのクラウド版 , RTX3510, RTX1300, RTX1220, RTX840, RTX830
30.5 RIPng
30.5.1 RIPng の使用の設定
[書式 ]
ipv6 rip use use
no ipv6 rip use
[設定値及び初期値 ]
•use
• [設定値 ] :500 | コマンドリファレンス  | IPv6

設定値 説明
on RIPng を使う
off RIPng を使わない
• [初期値 ] : off
[説明 ]
RIPng を使うか否かを設定する。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.5.2 インタフェースにおける  RIPng の送信ポリシーの設定
[書式 ]
ipv6 interface  rip send  send
ipv6 pp rip send  send
ipv6 tunnel  rip send  send
no ipv6 interface  rip send
no ipv6 pp rip send
no ipv6 tunnel  rip send
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•send
• [設定値 ] :
設定値 説明
on RIPng を送信する
off RIPng を送信しない
• [初期値 ] : on
[説明 ]
RIPng の送信ポリシーを設定する。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.5.3 インタフェースにおける  RIPng の受信ポリシーの設定
[書式 ]
ipv6 interface  rip receive  receive
ipv6 pp rip receive  receive
ipv6 tunnel  rip receive  receive
no ipv6 interface  rip receive
no ipv6 pp rip receive
no ipv6 tunnel  rip receive
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•receive
• [設定値 ] :
設定値 説明
on 受信した  RIPng パケットを処理するコマンドリファレンス  | IPv6 | 501

設定値 説明
off 受信した  RIPng パケットを無視する
• [初期値 ] : on
[説明 ]
RIPng の受信ポリシーを設定する。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.5.4 RIPng の加算ホップ数の設定
[書式 ]
ipv6 interface  rip hop direction  hop
ipv6 pp rip hop direction  hop
no ipv6 interface  rip hop direction
no ipv6 pp rip hop direction
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•direction
• [設定値 ] :
設定値 説明
in 受信時に加算する
out 送信時に加算する
• [初期値 ] : -
•hop
• [設定値 ] : 加算ホップ数  (0..15)
• [初期値 ] : 0
[説明 ]
PP インタフェースで送受信する  RIPng のメトリックに対して加算するホップ数を設定する。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.5.5 インタフェースにおける信頼できる  RIPng ゲートウェイの設定
[書式 ]
ipv6 interface  rip trust  gateway  [except] gateway  [gateway ...]
ipv6 pp rip trust  gateway  [except] gateway  [gateway ...]
no ipv6 interface  rip trust  gateway  [[except] gateway  [gateway ...]]
no ipv6 pp rip trust  gateway  [[except] gateway  [gateway ...]]
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•gateway
• [設定値 ] : IPv6 アドレス
• [初期値 ] : -
[説明 ]
信頼できる  RIPng ゲートウェイを設定する。
except キーワードを指定していない場合には、列挙したゲートウェイを信用できるゲートウェイとし、それらから502 | コマンドリファレンス  | IPv6

の RIP だけを受信する。
except キーワードを指定した場合は、列挙したゲートウェイを信用できないゲートウェイとし、それらを除いた他
のゲートウェイからの  RIP だけを受信する。
gatewayは10個まで指定可能。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.5.6 RIPng で送受信する経路に対するフィルタリングの設定
[書式 ]
ipv6 interface  rip filter  direction  filter_list  [filter_list ...]
ipv6 pp rip filter  direction  filter_list  [filter_list ...]
ipv6 tunnel  rip filter  direction  filter_list  [filter_list ...]
no ipv6 interface  rip filter  direction
no ipv6 pp rip filter  direction
no ipv6 tunnel  rip filter  direction
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•direction
• [設定値 ] :
設定値 説明
in 内向きのパケットを対象にする
out 外向きのパケットを対象にする
• [初期値 ] : -
•filter_list
• [設定値 ] : フィルタ番号
• [初期値 ] : -
[説明 ]
インタフェースで送受信する  RIPng パケットに対して適用するフィルタを設定する。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.5.7 回線接続時の  PP 側の  RIPng の動作の設定
[書式 ]
ipv6 pp rip connect  send  action
no ipv6 pp rip connect  send
[設定値及び初期値 ]
•action
• [設定値 ] :
設定値 説明
none RIPng を送信しない
interval ipv6 pp rip connect interval  コマンドで設定された時
間間隔で  RIPng を送出する
update 経路情報が変わった時にのみ  RIPng を送出する
• [初期値 ] : update
[説明 ]
選択されている相手について回線接続時に  RIPng を送出する条件を設定する。コマンドリファレンス  | IPv6 | 503

[設定例 ]
# ipv6 pp rip connect interval 60
# ipv6 pp rip connect send interval
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.5.8 回線接続時の  PP 側の  RIPng 送出の時間間隔の設定
[書式 ]
ipv6 pp rip connect  interval  time
no ipv6 pp rip connect  interval
[設定値及び初期値 ]
•time
• [設定値 ] : 秒数  (30..21474836)
• [初期値 ] : 30
[説明 ]
選択されている相手について回線接続時に  RIPng を送出する時間間隔を設定する。
[設定例 ]
# ipv6 pp rip connect interval 60
# ipv6 pp rip connect send interval
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.5.9 回線切断時の  PP 側の  RIPng の動作の設定
[書式 ]
ipv6 pp rip disconnect  send  action
no ipv6 pp rip disconnect  send
[設定値及び初期値 ]
•action
• [設定値 ] :
設定値 説明
none RIPng を送信しない
interval ipv6 pp rip connect interval  コマンドで設定された時
間間隔で  RIPng を送出する
update 経路情報が変わった時にのみ  RIPng を送信する
• [初期値 ] : none
[説明 ]
選択されている相手について回線切断時に  RIPng を送出する条件を設定する。
[設定例 ]
# ipv6 pp rip disconnect interval 1800
# ipv6 pp rip disconnect send interval
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.5.10 回線切断時の  PP 側の  RIPng 送出の時間間隔の設定
[書式 ]
ipv6 pp rip disconnect  interval  time
no ipv6 pp rip disconnect  interval504 | コマンドリファレンス  | IPv6

[設定値及び初期値 ]
•time
• [設定値 ] : 秒数  (30..21474836)
• [初期値 ] : 3600
[説明 ]
選択されている相手について回線切断時に  RIPng を送出する時間間隔を設定する。
[設定例 ]
# ipv6 pp rip disconnect interval 1800
# ipv6 pp rip disconnect send interval
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.5.11 RIPng による経路を回線切断時に保持するか否かの設定
[書式 ]
ipv6 pp rip hold  routing  hold
no ipv6 pp rip hold  routing
[設定値及び初期値 ]
•hold
• [設定値 ] :
設定値 説明
on 保持する
off 保持しない
• [初期値 ] : off
[説明 ]
PP インタフェースから  RIPng で得られた経路を、回線が切断されたときに保持するか否かを設定する。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.5.12 RIPng による経路の優先度の設定
[書式 ]
ipv6 rip preference  preference
no ipv6 rip preference  [preference ]
[設定値及び初期値 ]
•preference
• [設定値 ] : RIPng による経路の優先度  (1-2147483647)
• [初期値 ] : 1000
[説明 ]
RIPng による経路の優先度を設定する。優先度は  1 以上の数値で表され、数字が大きい程優先度が高い。
OSPFv3 とスタティックなど複数のプロトコルで得られた経路が食い違う場合には、優先度が高い方が採用される。
優先度が同じ場合には時間的に先に採用された経路が有効となる。
[ノート ]
静的経路の優先度は  10000 で固定である。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830コマンドリファレンス  | IPv6 | 505

30.6 VRRPv3 の設定
30.6.1 インタフェース毎の  VRRPv3 の設定
[書式 ]
ipv6 interface  vrrp  vrid ipv6_address  [priority= priority ] [preempt= preempt ] [auth= auth] [advertise-interval= time1 ] [down-
interval= time2 ]
no ipv6 interface  vrrp  vrid [vrid...]
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•vrid
• [設定値 ] : VRRPv3 グループ  ID (1..255)
• [初期値 ] : -
•ipv6_address
• [設定値 ] : 仮想ルーターの  IPv6 アドレス
• [初期値 ] : -
•priority
• [設定値 ] : 優先度  (1..254)
• [初期値 ] : 100
•preempt  : プリエンプトモード
• [設定値 ] :
設定値 説明
on 使用する
off 使用しない
• [初期値 ] : on
•auth
• [設定値 ] : テキスト認証文字列  (8 文字以内  )
• [初期値 ] : -
•time1
• [設定値 ] : VRRPv3 広告の送信間隔  (1..60秒)
• [初期値 ] : 1
•time2
• [設定値 ] : マスターがダウンしたと判定するまでの時間  (3..180秒)
• [初期値 ] : 3
[説明 ]
指定した  VRRPv3 グループを利用することを設定する。
同じ  VRRPv3 グループに所属するルーターの間では、 VRID および仮想ルーターの  IPv6 アドレスを一致させておか
なくてはいけない。これらが食い違った場合の動作は予測できない。
auth パラメータを指定しない場合には、認証なしとして動作する。
time1  および time2  パラメータで、マスターが  VRRPv3 広告を送信する間隔と、バックアップがそれを監視してダウ
ンと判定するまでの時間を設定する。トラフィックが多いネットワークではこれらの値を初期値より長めに設定す
ると動作が安定することがある。これらの値はすべての  VRRPv3 ルーターで一致している必要がある。
[ノート ]
priority  および preempt  パラメータの設定は、仮想ルーターの  IPv6 アドレスとして自分自身の  LAN インタフェース
に付与されているアドレスを指定している場合には無視される。この場合、優先度は最高の  255 となり、常にプリ
エンプトモードで動作する。506 | コマンドリファレンス  | IPv6

RTX5000 / RTX3500 Rev.14.00.17 以前では使用不可能。
[適用モデル ]
vRX VMware ESXi 版, RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.6.2 シャットダウントリガの設定
[書式 ]
ipv6 interface  vrrp  shutdown  trigger  vrid interface
ipv6 interface  vrrp  shutdown  trigger  vrid pp peer_num  [dlci= dlci]
ipv6 interface  vrrp  shutdown  trigger  vrid tunnel tunnel_num
ipv6 interface  vrrp  shutdown  trigger  vrid route network  [nexthop ]
no ipv6 interface  vrrp  shutdown  trigger  vrid interface
no ipv6 interface  vrrp  shutdown  trigger  vrid pp peer_num  [...]
no ipv6 interface  vrrp  shutdown  trigger  vrid tunnel tunnel_num
no ipv6 interface  vrrp  shutdown  trigger  vrid route network
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•vrid
• [設定値 ] : VRRPv3 グループ  ID (1..255)
• [初期値 ] : -
•peer_num
• [設定値 ] : 相手先情報番号
• [初期値 ] : -
•dlci
• [設定値 ] : DLCI 番号
• [初期値 ] : -
•tunnel_num
• [設定値 ] : tunnel インターフェース  番号
• [初期値 ] : -
•network
• [設定値 ] :
• IPv6 プレフィックス /プレフィックス長
• default
• [初期値 ] : -
•nexthop
• [設定値 ] :
•インタフェース名
• IPv6 アドレス
• [初期値 ] : -
[説明 ]
設定した  VRRPv3 グループでマスタールーターとして動作している場合に、指定した条件によってシャットダウン
することを設定する。
形式 説明
LAN インタフェース形式指定した  LAN インタフェースがリンクダウンするか、
あるいは lan keepalive  でダウンが検知されると、シャッ
トダウンする。コマンドリファレンス  | IPv6 | 507

形式 説明
pp 形式指定した相手先情報番号に該当する回線で通信できな
くなった場合にシャットダウンする。通信できなくな
るとは、ケーブルが抜けるなどレイヤ  1 が落ちた場合
と、以下の場合である。
•回線が  ISDN 回線である時は、 呼が接続されていない
場合
•回線が専用線である時には、 LCP キープアライブに
よって通信相手が落ちたと判断した場合
•回線がフレームリレーであって ”dlci= dlci”を指定して
いる場合には、 PVC 状態確認手順によって指定した
DLCI 番号が通信できないと判断した場合
•pp keepalive use  設定によりダウンが検出された場合
tunnel 形式指定した tunnel インターフェースが以下の条件により
ダウンした場合にシャットダウンする。
• IPsec トンネルで、 ipsec ike keepalive use 設定により
ダウンが検出された場合
• L2TP/IPsec 、L2TPv3、L2TPv3/IPsec のいずれかのトン
ネルで、 l2tp keepalive use 設定によりダウンが検出さ
れた場合
• PPTP トンネルで、 pptp keepalive use 設定によりダウ
ンが検出された場合
• IPIPトンネルで、 ipip keepalive use  設定によりダウン
が検出された場合
route 形式指定した経路が経路テーブルに存在しないか、 nexthop  で
指定したインタフェースもしくは  IPv6 アドレスで指定
するゲートウェイに向いていない場合に、シャットダウ
ンする。 nexthop  を省略した場合には、 経路がどのような
先を向いていても存在する限りはシャットダウンしな
い。
[ノート ]
RTX5000 / RTX3500 Rev.14.00.17 以前では使用不可能。
tunnel インターフェースは、 RTX5000 / RTX3500 Rev.14.00.31 以前、 RTX1210 Rev.14.01.27 以前、および  RTX830
Rev.15.02.02 以前では使用不可能。
[適用モデル ]
vRX VMware ESXi 版, RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.7 フィルタの設定
30.7.1 IPv6 フィルターの定義
[書式 ]
ipv6 filter  filter_num  pass_reject  src_addr [/prefix_len ] [dest_addr [/prefix_len ] [protocol  [src_port_list  [dest_port_list ]]]]
no ipv6 filter  filter_num  [pass_reject ]
[設定値及び初期値 ]
•filter_num
• [設定値 ] : 静的フィルター番号  (1..21474836)
• [初期値 ] : -
•pass_reject
• [設定値 ] : フィルターのタイプ  (ip filter  コマンドに準ずる  )
• [初期値 ] : -
•src_addr  : IPv6 パケットの始点  IPv6 アドレス
• [設定値 ] :508 | コマンドリファレンス  | IPv6

• IPv6アドレス
•静的または動的 IPv6アドレス
• , を区切りとして複数設定することができる。
• FQDN
•任意の文字列  (半角  255 文字以内。 / ： は使用できない。 , は区切り文字として使われるため、使用でき
ない )
• * から始まる  FQDN は * より後ろの文字列を後方一致条件として判断する  例えば  *.example.co.jp は
www.example.co.jp 、mail.example.co.jp などと一致する
• , を区切りとして複数設定することができる。
• map-e
• MAP-E のマップルールにより生成され、 MAP-Eトンネルに設定されたグローバル IPv6アドレスを表す
キーワード
• hb46pp
• IPv6 マイグレーション技術の国内標準プロビジョニング方式により取得したグローバル  IPv6 アドレス
を表すキーワード
•アプリケーション名を表すニーモニック  (ip filter  コマンドに準ずる  )
• * (すべての  IPv6 アドレスに対応 )
• [初期値 ] : -
•prefix_len
• [設定値 ] : プレフィックス長
• [初期値 ] : -
•dest_addr  : IPv6 パケットの終点  IPv6 アドレス
• [設定値 ] :
•src_addr  と同じ形式
•省略した場合は一個の  * と同じ
• [初期値 ] : -
•protocol  : フィルタリングするパケットの種類  (ip filter コマンドに準ずる  )
• [設定値 ] :
icmp-nd近隣探索に関係するパケットの指定を示すキーワー
ド。 (TYPE が 133、134、135、136 のいずれかである
ICMPv6 パケット  )
icmp4 ICMPv4 パケットの指定を示すキーワード
icmp
ICMPv6 パケットの指定を示すキーワード
icmp6
• [初期値 ] : -
•src_port_list
• [設定値 ] : TCP/UDP のソースポート番号、あるいは  ICMPv6 タイプ  (ip filter  コマンドに準ずる  )
• [初期値 ] : -
•dest_port_list
• [設定値 ] : TCP/UDP のデスティネーションポート番号、あるいは  ICMPv6 コード
• [初期値 ] : -
[説明 ]
IPv6 のフィルターを定義する。
[ノート ]
近隣探索に関係するパケットとは以下の  4 つを意味する。
• 133: Router Solicitation
• 134: Router Advertisement
• 135: Neighbor Solicitation
• 136: Neighbor Advertisementコマンドリファレンス  | IPv6 | 509

src_addr  および  dest_addr  は IPv6 アドレス、 FQDN、map-e、hb46pp、およびアプリケーション名を表すニーモニッ
クを混合することも可能。
src_addr  および  dest_addr  への  FQDN の指定は、 vRX Amazon EC2 版、 vRX VMware ESXi 版、 RTX5000 / RTX3500
Rev.14.00.31 以前、 RTX1220 Rev.15.04.03 以前、 RTX1210 Rev.14.01.40 以前、および  RTX830 Rev.15.02.23 以前では不
可能。
src_addr  および  dest_addr  に FQDN を指定することによって、固定  IP アドレスではないサーバーや  1 つの  FQDN に
対して複数の固定  IP アドレスを持つサーバーを対象にしたフィルタリングを行うことができる。 FQDN を使用す
る場合、ルーター自身が  DNS リカーシブサーバーとして動作し、ルーター配下の端末は  DNS サーバーとして本機
を指定する必要がある。
指定した  FQDN に一致する通信が発生した場合、 設定した  FQDN に該当する  IPv6 アドレスの情報が保持される。保
持される期間は、  ip filter fqdn timer  コマンドで指定できる。
src_addr  および  dest_addr  への  map-e の指定は、 vRX シリーズ、 RTX5000 / RTX3500 Rev.14.00.31 以前、 RTX1210
Rev.14.01.39 以前、および  RTX830 Rev.15.02.19 以前では不可能。
src_addr  および  dest_addr  への  hb46pp の指定は、 vRX シリーズ、 RTX5000 、RTX3510 Rev.23.01.01 、RTX3500 、RTX1300
Rev.23.00.11 以前、 RTX1220 Rev.15.04.06 以前、 RTX1210 、および  RTX830 Rev.15.02.30 以前では不可能。
src_addr  および  dest_addr  へのアプリケーション名を表すニーモニックの指定は、 vRX シリーズ、 RTX5000 、
RTX3510 、RTX3500 、RTX1300 、RTX1220 、RTX1210 、および  RTX830 では不可能。
アプリケーション名を表すニーモニックには、通信先リストに記載されたニーモニックを指定する。
以下の状態では、アプリケーション名を表すニーモニックは評価されない。
• LBO の状態が "正常動作中 "でないとき
•指定されたニーモニックが、通信先リストに含まれていないとき
[設定例 ]
• PP 1 で送受信される  IPv6 Packet Too Big を記録する
# pp select 1
# ipv6 pp secure filter in 1 100
# ipv6 pp secure filter out 1 100
# pp enable 1
# ipv6 filter 1 pass-log * * icmp6 2
# ipv6 filter 100 pass * *
• Microsoft 365 および  Windows Update のパケットは  PP1 経由で、その他は  TUNNEL1 経由で送信する
# ipv6 route default gateway pp 1 filter 1 gateway tunnel 1
# ipv6 filter 1 pass * @m365,@windows_update * *
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.7.2 IPv6 フィルタの適用
[書式 ]
ipv6 interface  secure  filter  direction  [filter_list ...] [dynamic filter_list ]
ipv6 pp secure  filter  direction  [filter_list ...] [dynamic filter_list ]
ipv6 tunnel  secure  filter  direction  [filter_list ...] [dynamic filter_list ]
no ipv6 interface  secure  filter  direction
no ipv6 pp secure  filter  direction
no ipv6 tunnel  secure  filter  direction
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名、 LOOPBACK インタフェース名、 NULL インタフェース名、ブリッジイン
タフェース名
• [初期値 ] : -
•direction
• [設定値 ] :510 | コマンドリファレンス  | IPv6

設定値 説明
in 受信したパケットのフィルタリング
out 送信するパケットのフィルタリング
• [初期値 ] : -
•filter_list
• [設定値 ] : 空白で区切られたフィルタ番号の並び  (静的フィルタと動的フィルタの数の合計として  129 個以
内 )
• [初期値 ] : -
• dynamic : キーワード後に動的フィルタの番号を記述する
• [初期値 ] : -
[説明 ]
IPv6 フィルタをインタフェースに適用する。
[ノート ]
LOOPBACK インタフェースと  NULL インタフェースでは動的フィルタは使用できない。
NULL インタフェースで direction  に 'in' は指定できない。
ブリッジインタフェースは、 vRX Amazon EC2 版、および  RTX5000 / RTX3500 Rev.14.00.11 以前では指定不可能。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.7.3 IPv6 動的フィルターの定義
[書式 ]
ipv6 filter  dynamic  dyn_filter_num  srcaddr [/prefix_len ] dstaddr [/prefix_len ] protocol  [option  ...]
ipv6 filter  dynamic  dyn_filter_num  srcaddr [/prefix_len ] dstaddr [/prefix_len ] filter filter_list  [in filter_list ] [out filter_list ]
[option  ...]
no ipv6 filter  dynamic  dyn_filter_num  [srcaddr  ...]
[設定値及び初期値 ]
•dyn_filter_num
• [設定値 ] : 動的フィルター番号  (1..21474836)
• [初期値 ] : -
•srcaddr  : IPv6 パケットの始点  IPv6 アドレス
• [設定値 ] :
•ipv6 filter  コマンドの  src_addr  と同じ形式
•省略した場合は一個の  * と同じ
• [初期値 ] : -
•prefix_len
• [設定値 ] : プレフィックス長
• [初期値 ] : -
•dstaddr  : IPv6 パケットの終点  IPv6 アドレス
• [設定値 ] :
•srcaddr  と同じ形式
•省略した場合は一個の  * と同じ
• [初期値 ] : -
•protocol  : プロトコルのニーモニック
• [設定値 ] :
• tcp/udp/ftp/tftp/domain/www/smtp/pop3/telnet
• echo/discard/daytime/chargen/ftp/ssh/telnet/smtp/time/whois/dns/domain/dhcps/
• dhcpc/tftp/gopher/finger/http/www/pop3/sunrpc/ident/nntp/ntp/ms-rpc/
• netbios_ns/netbios_dgm/netbios_ssn/imap/snmp/snmptrap/bgp/imap3/ldap/
• https/ms-ds/ike/rlogin/rwho/rsh/syslog/printer/rip/ripng/
• dhcpv6c/dhcpv6s/ms-sql/radius/l2tp/pptp/nfs/msblast/ipsec-nat-t/sip/コマンドリファレンス  | IPv6 | 511

• ping/ping6/tcp/udp
• submission
• [初期値 ] : -
•filter_list
• [設定値 ] : ipv6 filter  コマンドで登録されたフィルター番号のリスト
• [初期値 ] : -
•option
• [設定値 ] :
• syslog= switch
設定値 説明
on コネクションの通信履歴を  syslog に残す
off コネクションの通信履歴を  syslog に残さない
• timeout= time
設定値 説明
timeデータが流れなくなったときにコネクション情報
を解放するまでの秒数
• [初期値 ] :
• syslog=on
[説明 ]
IPv6 の動的フィルターを定義する。第  1 書式では、あらかじめルーターに登録されているアプリケーション名を指
定する。第  2 書式では、ユーザーがアクセス制御のルールを記述する。キーワードの  filter、in、out の後には、 ipv6
filter  コマンドで定義されたフィルター番号を設定する。
filter キーワードの後に記述されたフィルターに該当するコネクション  ( トリガー  ) を検出したら、それ以降  in キー
ワードと  out キーワードの後に記述されたフィルターに該当するコネクションを通過させる。 in キーワードはトリ
ガーの方向に対して逆方向のアクセスを制御し、 out キーワードは動的フィルターと同じ方向のアクセスを制御す
る。なお、 ipv6 filter  コマンドの  IP アドレスは無視される。  pass/reject の引数も同様に無視される。
ここに記載されていないアプリケーションについては、 filter キーワードを使って定義することで扱える可能性があ
る。特に  snmp のように動的にポート番号が変化しないプロトコルの扱いは容易である。
tcp か udp を設定することで扱える可能性がある。特に、 telnet のように動的にポート番号が変化しないプロトコル
は tcp を指定することで扱うことができる。
[ノート ]
src_addr  および  dstaddr  は IP アドレス、 FQDN、map-e、hb46pp、およびアプリケーション名を表すニーモニックを
混合することも可能。
srcaddr  および  dstaddr  への  FQDN の指定は、 vRX Amazon EC2 版、 vRX VMware ESXi 版、 RTX5000 / RTX3500
Rev.14.00.31 以前、 RTX1220 Rev.15.04.03 以前、 RTX1210 Rev.14.01.40 以前、および  RTX830 Rev.15.02.23 以前では不
可能。
src_addr  および  dstaddr  への  map-e の指定は、 vRX シリーズ、 RTX5000 Rev.14.00.31 以前、 RTX3500 Rev.14.00.31 以
前、 RTX1210 Rev.14.01.39 以前、および  RTX830 Rev.15.02.19 以前では不可能。
src_addr  および  dstaddr  への  hb46pp の指定は、 vRX シリーズ、 RTX5000 、RTX3510 Rev.23.01.01 、RTX3500 、RTX1300
Rev.23.00.11 以前、 RTX1220 Rev.15.04.06 以前、 RTX1210 、および  RTX830 Rev.15.02.30 以前では不可能。
src_addr  および  dstaddr  へのアプリケーション名を表すニーモニックの指定は、 vRX シリーズ、 RTX5000 、
RTX3510 、RTX3500 、RTX1300 、RTX1220 、RTX1210 、および  RTX830 では不可能。
アプリケーション名を表すニーモニックには、通信先リストに記載されたニーモニックを指定する。
以下の状態では、アプリケーション名を表すニーモニックは評価されない。
• LBO の状態が "正常動作中 "でないとき
•指定されたニーモニックが、通信先リストに含まれていないとき512 | コマンドリファレンス  | IPv6

[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.8 IPv6 マルチキャストパケットの転送の設定
MLDv1、MLDv2、MLD プロキシの機能を提供します。 MLDv1 と MLDv2 については、ホスト側とルーター側の双
方に対応し、インタフェースごとにホストとルーターの機能を使い分けることができます。 MLDv1 は RFC2710 、
MLDv2 は draft-vida-mldv2-07.txt に対応します。 MLD プロキシは、下流のインタフェースに存在するリスナーの情
報を、上流のインタフェースに中継する機能であり、 draft-ietf-magma-igmp-proxy-04.txt に基づいて実装しています。
特定の端末が送信するマルチキャストパケットを複製して、複数の端末に配送します。マルチキャストパケットを
送信する端末をソース  (source) と呼び、それを受信する端末をリスナー (listener) と呼びます。以下の説明では、マル
チキャストパケットを単にパケットと書きます。
ソースが送信するパケットは原則としてすべてのリスナーに届きます。しかし、リスナーによって受信するパケッ
トを変えたければ、リスナーをグループに分けることができます。同じグループに属する端末は同じパケットを受
信し、異なるグループに属する端末は異なるパケットを受信します。それぞれのグループには識別子としてマルチ
キャストアドレスが割り当てられます。
パケットの  IP ヘッダの終点アドレスには、グループに対応するマルチキャストアドレスが格納されます。網内のル
ーターは、このマルチキャストアドレスを見て、パケットの転送先のグループを確認します。網内のルーターはグ
ループごとに編成された経路表を持っているので、その経路表にしたがってパケットを配布します。経路表は、通
常、 PIM-SM、PIM-DM、DVMRP などのルーティングプロトコルによって自動的に生成されます。
MLD(MulticastListenerDiscovery) の目的は、端末がマルチキャスト網に対して、端末が参加するグループを通知する
ことです。
網内のルーターは端末に対してクエリー (Query) というメッセージを送信します。クエリーを受信した端末は、ルー
ターに対してレポート  (Report) というメッセージを返信します。レポートの中には、端末が参加するグループのマ
ルチキャストアドレスを格納します。レポートを受信したルーターはその情報をルーティングに反映します。
MLDv2 では、受信するパケットのソースを制限することができますが、この機能を実現するためにフィルタモード
(FilterMode) とソースリスト  (SourceList) を使用します。フィルタモードには  INCLUDE と EXCLUDE があり、
INCLUDE では許可するソースを列挙し、 EXCLUDE では許可しないソースを列挙します。
例えば、次の場合には、 2001:x:x:x::1 と 2001:x:x:x::2 をソースとするパケットだけが転送の対象になります。
•フィルタモード  : INCLUDE
•ソースリスト  : { 2001:x:x:x::1, 2001:x:x:x::2 }
MLD のメッセージは原則としてルーターを超えることができません。そこで、端末とマルチキャスト網の間にルー
ターが介在する場合には、ルーターが  MLD プロキシの機能を持つ必要があります。 MLD プロキシの機能を持つル
ーターは、 LAN 側に対してクエリを送信し、 LAN 側からレポートを受信します。また、そのレポートに含まれる情
報を  WAN 側に転送します。
30.8.1 MLD の動作の設定
[書式 ]
ipv6 interface  mld type [option  ...]
ipv6 pp mld type [option  ...]
ipv6 tunnel  mld type [option  ...]
no ipv6 interface  mld [type [option  ...]]
no ipv6 pp mld [type [option  ...]]
no ipv6 tunnel  mld [type [option  ...]]
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•type : MLD の動作方式
• [設定値 ] :
設定値 説明
off MLD は動作しないコマンドリファレンス  | IPv6 | 513

設定値 説明
router MLD ルーターとして動作する
host MLD ホストとして動作する
• [初期値 ] : off
•option  : オプション
• [設定値 ] :
• version= version
• MLD のバージョン
設定値 説明
1 MLDv1
2 MLDv2
1,2MLDv1 と MLDv2 の両方に対応する。 (MLDv1 互
換モード  )
• syslog= switch
•詳細な情報を  syslog に出力するか否か
設定値 説明
on 表示する
off 表示しない
• robust-variable=V ALUE(1..10)
• MLD で規定される  Robust Variable の値を設定する。
• report-link-local-group= switch
•リンクローカルスコープのグループを処理するか否か
設定値 説明
onMLD ルーターとして動作しているとき、 リンクロ
ーカルスコープのグループのレポート受信を有効
にする。 MLD ホストとして動作しているとき、 リ
ンクローカルスコープのグループのレポート送信
を有効にする。
offリンクローカルスコープのグループのレポート送
受信を無効にする。
• [初期値 ] :
• version=1,2
• syslog=off
• robust-variable=2
• report-link-local-group=off
[説明 ]
インタフェースの  MLD の動作を設定する。
[ノート ]
report-link-local-group オプションは、 RTX5000 / RTX3500 Rev.14.00.20 以前、および  RTX1210 Rev.14.01.15 以前では
指定不可能。
[適用モデル ]
RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.8.2 MLD の静的な設定
[書式 ]
ipv6 interface  mld static  group  [filter_mode  [source ...]]
ipv6 pp mld static  group  [filter_mode  [source ...]]
ipv6 tunnel  mld static  group  [filter_mode  [source ...]]514 | コマンドリファレンス  | IPv6

no ipv6 interface  mld static  group  [filter_mode  source ...]
no ipv6 pp mld static  group  [filter_mode  source ...]
no ipv6 tunnel  mld static  group  [filter_mode  source ...]
[設定値及び初期値 ]
•interface
• [設定値 ] : LAN インタフェース名
• [初期値 ] : -
•group
• [設定値 ] : グループのマルチキャストアドレス
• [初期値 ] : -
•filter_mode  : フィルタモード
• [設定値 ] :
設定値 説明
include MLD の "INCLUDE" モード
exclude MLD の "EXCLUDE" モード
• [初期値 ] : -
•source
• [設定値 ] :
設定値 説明
IPv6 アドレス マルチキャストパケットの送信元アドレス
省略 省略時はすべての送信元アドレスに対して同様に動
作する
• [初期値 ] : -
[説明 ]
指定したグループについて、常にリスナーが存在するものとみなす。このコマンドは、 MLD をサポートするリスナ
ーがいないときに設定する。 filter_mode  とsource  は、マルチキャストパケットの送信元を限定するものである。
filter_mode  として  include を指定したときには、 source  として受信したい送信元を列挙する。 sourceを省略した場合
は、全ての送信元からの要求を受信しない。
filter_mode  として  exclude を指定したときには、 source  として受信したくない送信元を列挙する。 sourceを省略した
場合は、全ての送信元からの要求を受信する。
[ノート ]
このコマンドで設定されたリスナーは、 ipv6 interface  mld コマンドで  host を設定したインタフェースで通知される。
もし、このインタフェースが  MLDv1 を使う場合には、 filter_mode  やsource  の値は無視される。
[適用モデル ]
RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
30.9 近隣要請
30.9.1 アドレス重複チェックをトリガに近隣要請を行うか否かの設定
[書式 ]
ipv6 nd ns-trigger-dad  on [option =value ]
ipv6 nd ns-trigger-dad  off
no ipv6 nd ns-trigger-dad  [...]
[設定値及び初期値 ]
• on
• [設定値 ] : 近隣要請を行う
• [初期値 ] : -
• off
• [設定値 ] : 近隣要請を行わないコマンドリファレンス  | IPv6 | 515

• [初期値 ] : -
•option=value 列 : MLD の動作方式
• [設定値 ] :
option value 説明
na-proxyall近隣要請を行った後で、アドレス
重複チェックの送信元への近隣広
告はすべてプロキシする
discard-one-time近隣要請を行った後で、アドレス
重複チェックの送信元への近隣広
告を一回のみ破棄し、その後はプ
ロキシする
• [初期値 ] : na-proxy=all
[初期設定 ]
ipv6 nd ns-trigger-dad off
[説明 ]
RA プロキシにおいて、下流よりアドレス重複チェックの近隣要請を受信した際に、そのグローバルアドレスを送信
元とした近隣要請を上流に送信するか否かを設定する。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830516 | コマンドリファレンス  | IPv6

