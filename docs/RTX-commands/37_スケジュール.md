# 第37章: スケジュール

> 元PDFページ: 550-553

---

第 37 章
スケジュール
37.1 スケジュールの設定
[書式 ]
schedule  at id [date] time * command ...
schedule  at id [date] time pp peer_num  command ...
schedule  at id [date] time tunnel tunnel_num  command ...
schedule  at id [date] time switch switch  command ...
schedule  at id +timer  * command ...
schedule  at id +timer  pp peer_num  command ...
schedule  at id +timer  tunnel tunnel_num  command ...
schedule  at id +timer  switch switch  command ...
no schedule  at id [[date]...]
[設定値及び初期値 ]
•id
• [設定値 ] : スケジュール番号
• [初期値 ] : -
•date : 日付  ( 省略可  )
• [設定値 ] :
•月/日
•省略時は  */* とみなす
月の設定例 設定内容
1,2 1 月と  2 月
2- 2 月から  12 月まで
2-7 2 月から  7 月まで
-7 1 月から  7 月まで
* 毎月
日の設定例 設定内容
1 1 日のみ
1,2 1 日と  2 日
2- 2 日から月末まで
2-7 2 日から  7 日まで
-7 1 日から  7 日まで
mon 月曜日のみ
sat,sun 土曜日と日曜日
mon-fri 月曜日から金曜日
-fri 日曜日から金曜日
* 毎日
• [初期値 ] : -
•time : 時刻
• [設定値 ] :550 | コマンドリファレンス  | スケジュール

設定値 説明
hh:mm[:ss] 時 (0..23 または  *): 分 (0..59 または  *): 秒 (0..59)、秒は
省略可
startup 起動時
usb-attached USB デバイス認識時
( vRX シリーズ  では指定不可能  )
sd-attached microSD デバイス認識時
( vRX シリーズ  では指定不可能  )
• [初期値 ] : -
•timer  : command  を実行するまでの時間  ( 秒、 1..3600 )
• [初期値 ] : -
•peer_num
• [設定値 ] :
•相手先情報番号
• anonymous
• [初期値 ] : -
•tunnel_num
• [設定値 ] : トンネルインタフェースの番号
• [初期値 ] : -
•switch  : スイッチ
• [設定値 ] :
• MAC アドレス
•経路
• [初期値 ] : -
•command
• [設定値 ] : 実行するコマンド  ( 制限あり  )
• [初期値 ] : -
[説明 ]
time で指定した時刻、または  timer  で指定した時間後に、 command  で指定されたコマンドを実行する。
第 2、第  3、第  4 書式で指定された場合には、それぞれあらかじめ指定された相手先情報番号 /トンネル番号 /スイッ
チでの、 pp select /tunnel select /switch select  コマンドが発行済みであるように動作する。
schedule at  コマンドは複数指定でき、同じ時刻に指定されたものは id の小さな順に実行される。
time は hh:mm 形式で指定されたときは秒指定なしとみなされ、 hh:mm:ss 形式で指定されたときは秒指定ありとみな
される。秒数に  "-" を用いた範囲指定や  "*" による全指定をすることはできない。
以下のコマンドは指定できない。
administrator 、administrator password 、administrator password encrypted 、ap select  (※1)、auth user 、auth user
group、bgp configure refresh 、clear vrx license 、cold start 、confirm、console info  とconsole prompt  を除く console  で
始まるコマンド、 copy、copy exec 、date、delete、echo、embedded file 、exit、export vrx license 、external-memory
performance-test go 、help、import vrx license 、http revision-up go 、http revision-up schedule 、interface reset 、ipsec
transport template 、ipv6 bgp configure refresh 、ipv6 ospf configure refresh 、less で始まるコマンド、 load、login
password 、login password encrypted 、login timer 、login user 、luac、macro、make directory 、nslookup 、ospf configure
refresh、packetdump 、ping、ping6、pp select  (※2)、quit、remote setup 、rename、rollback timer 、rtfs format 、rtfs
garbage collect 、save、schedule at 、scp、show  で始まるコマンド、 ssh、sshd host key generate 、sshd session 、switch
control function get  FUNCTION 、switch select  (※1)、system packet-buffer 、telnet、telnetd session 、time、timezone 、
traceroute 、traceroute6 、tunnel select  (※2)、tunnel template 、user attribute 、vrx license update schedule
• (※1) のコマンドは、 RTX1210 Rev.14.01.26 以降、 RTX830 Rev.15.02.03 以降、 RTX1220 、および  RTX1300 では指
定可能。
• (※2) のコマンドは、 RTX5000 / RTX3500 Rev.14.00.25 以前、 RTX1210 Rev.14.01.25 以前、および  RTX830
Rev.15.02.02 以前を除く各機種・リビジョンでは指定可能。コマンドリファレンス  | スケジュール  | 551

•load コマンドは、 RTX5000 / RTX3500 Rev.14.00.25 以前、 RTX1210 Rev.14.01.27 以前、および  RTX830 Rev.15.02.02
以前を除く各機種・リビジョンでは指定可能。
[ノート ]
入力時、 command  パラメータに対して  TAB キーによるコマンド補完は行うが、シンタックスエラーなどは実行時ま
で検出されない。 schedule at  コマンドにより指定されたコマンドを実行する場合には、何を実行しようとしたかを
INFO タイプの  SYSLOG に出力する。
date に数字と曜日を混在させて指定はできない。
startup を指定したスケジュールはルーター起動時に実行される。電源を入れたらすぐ発信したい場合などに便利。
第 4 書式は、 RTX1300 、RTX1220 、RTX1210 、RTX840、および  RTX830 で使用可能。
第 5 ～ 7 書式は、 RTX5000 / RTX3500 Rev.14.00.31 以前、 RTX1220 Rev.15.04.03 以前、 RTX1210 Rev14.01.40 以前、お
よび  RTX830 Rev.15.02.02 以前では使用不可能。
第 8 書式は  RTX5000 、RTX3500 、RTX1220 Rev.15.04.03 以前、 RTX1210 Rev14.01.40 以前、 および  RTX830 Rev.15.02.01
では使用不可能。
[設定例 ]
•ウィークデイの  8:00～17:00 だけ接続を許可する
# schedule at 1 */mon-fri 8:00 pp 1 isdn auto connect on
# schedule at 2 */mon-fri 17:00 pp 1 isdn auto connect off
# schedule at 3 */mon-fri 17:05 * disconnect 1
•毎時  0 分から  15 分間だけ接続を許可する
# schedule at 1 *:00 pp 1 isdn auto connect on
# schedule at 2 *:15 pp 1 isdn auto connect off
# schedule at 3 *:15 * disconnect 1
•今度の元旦にルーティングを切替える
# schedule at 1 1/1 0:0 * ip route NETWORK gateway pp 2
•毎日  12 時から  13 時の間だけ  20 秒間隔で  Lua スクリプトを実行する
# schedule at 1 12:*:00 * lua script.lua
# schedule at 2 12:*:20 * lua script.lua
# schedule at 3 12:*:40 * lua script.lua
•毎日  3 時にスイッチを再起動する
# schedule at 1 */* 03:00 switch 00:a0:de:01:02:03 switch control function execute 
restart
# schedule at 2 */* 03:00 switch lan1:4 switch control function execute restart
•コマンド設定時から 10分後に再起動する
# schedule at 1 +600 * restart
[拡張ライセンス対応 ]
拡張ライセンス をインポートすると、以下のパラメーターに入力できる上限値が拡張される。
•tunnel_num
ライセンス名拡張後の上限値
( ライセンス本数ごとの値  )
1本 2本 3本 4本 5本
YSL-VPN-EX1 100 - - - -
YSL-VPN-EX2 300 500 700 900 1100
YSL-VPN-EX3 1500 2000 2500 3000 -
•peer_num552 | コマンドリファレンス  | スケジュール

ライセンス名拡張後の上限値
( ライセンス本数ごとの値  )
1本 2本 3本 4本 5本
YSL-VPN-EX1 100 - - - -
YSL-VPN-EX2 150
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830コマンドリファレンス  | スケジュール  | 553

