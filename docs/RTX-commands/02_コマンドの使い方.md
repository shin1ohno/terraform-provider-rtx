# 第2章: コマンドの使い方

> 元PDFページ: 31-48

---

第 2 章
コマンドの使い方
ヤマハルーター  に直接コマンドを  1 つ 1 つ送って機能を設定したり操作したりする方法と、必要なコマンド一式を
記述したファイルを送信して設定する方法の  2 種類をサポートしています。 LAN インタフェースが使用できない場
合は、 CONSOLE または  SERIAL ポートや、仮想マシンコンソールを使ってコマンドを実行し、復旧などの必要な
操作を行うことができます。
対話的に設定する手段をコンソールと呼び、コマンドを  1 つ 1 つ実行して設定や操作を行うことができます。必要
なコマンド一式を記述したファイルを設定ファイル  (Config) と呼び、 TFTP により  ヤマハルーター  にアクセスでき
る環境から設定ファイルを送信したり受信したりすることが可能です。
2.1 コンソールについて
各種設定を行うには、以下のいずれかの方法で  ヤマハルーター  へアクセスします。
ヤマハルーター  へのアクセス方法 対応機種
CONSOLE または  SERIAL ポートに接続した端末からア
クセスvRX シリーズ  を除く各機種
仮想マシンコンソールでログイン vRX Amazon EC2 版 を除く  vRX シリーズ
LAN 上のホストから  TELNET または  SSH でログイン 全機種
ISDN 回線や専用線を介して別の  ヤマハルーター  から
ログインRTX5000, RTX3500, RTX1210
ヤマハルーター  へは、それぞれに対して  1 ユーザがアクセスすることができます。またその中で管理ユーザになれ
るのは同時に  1 ユーザだけです。例えば、シリアル端末でアクセスしているユーザが管理ユーザとして設定を行っ
ている場合には、別のユーザが一般ユーザとしてアクセスすることはできても管理ユーザになって設定を行うこと
はできません。
TELNET 複数セッション機能および  SSH サーバー機能に対応した機種については、 TELNET または  SSH による同時
アクセスが最大  8 ユーザまで可能です。また複数のユーザが同時に管理ユーザになることができ、異なるホストか
ら同時に設定を行うこともできます。そのほか、各ユーザは現在アクセスしている全ユーザのアクセス状況を確認
することができ、管理ユーザならば他のユーザの接続を強制的に切断させることもできます。
2.1.1 コンソールによる設定手順
CONSOLE または  SERIAL ポートから設定を行う場合は、まず  ヤマハルーター  の CONSOLE または  SERIAL ポート
とパソコンをクロスタイプのシリアルケーブルで接続します。シリアルケーブルの両端のコネクタはパソコンに適
合したタイプをご使用ください。コマンドリファレンス  | コマンドの使い方  | 31

パソコンではターミナルソフトを使います。 Windows をお使いの場合には、ターミナル機能のあるソフトウェアを
用意してください。 macOS をお使いの場合は、 OS に付属の『ターミナル』アプリケーションを使用します。
仮想マシンコンソールで設定を行う場合は、 vRX シリーズ  を実行しているハイパーバイザーの管理ソフトウェアが
提供しているコンソール機能を使用します。
TELNET で設定を行う場合は、パソコンでは  TELNET アプリケーションを使います。 Windows をお使いの場合は
OS に付属の『 TELNET 』ソフトウェアを使用します。 macOS をお使いの場合は、 OS に付属の『ターミナル』アプ
リケーションで  telnet コマンドを実行します。
コンソールコマンドの具体的な内容については、本書の第  3 章以降をご覧ください。
コンソールコマンドは、コマンドの動作をよく理解した上でお使いください。設定後に意図した動作をするかどう
か、必ずご確認ください。
コンソールに表示される文字セットの初期値は以下の通りです。これは、 console character  コマンドを使用して端末
の文字表示の能力に応じて選択できます。いずれの場合でもコマンドの入力文字は  ASCII で共通であることに注意
してください。
• vRX シリーズ
• UTF-8
•その他の機種
•シフト  JIS
設定手順のおおまかな流れは次のようになります。
1.一般ユーザーとしてログインした後、  administrator  コマンドで管理ユーザーとしてアクセスします。この時管
理パスワードが設定してあれば、管理パスワードの入力が必要です。
2.回線を接続していない相手の相手先情報を変更する場合には、 pp disable  コマンドを実行してから相手先情報の
内容を変更してください。回線が接続されている場合には、 disconnect  コマンドでまず回線を手動切断しておき
ます。
3.各種コマンドを使用して、相手先情報の内容を変更します。
4. pp enable  コマンドを実行します。
5. save  コマンドを実行して、不揮発性メモリに設定内容を保存します。
注 : Ctrl キーを押しながら  S キーを押すと、コンソール出力を一時停止します。この状態でキーを押しても
画面上は無反応に見えますが、キー入力は処理されます。コンソール出力を再開するには  Crtl キーを押しな
がら  Q キーを押します。
セキュリティーの観点から、コンソールにキー入力が一定時間無い時には、自動的に  300 秒 ( 初期値  ) でログアウト
するように設定されています。この時間は login timer  コマンドを使用して変更することができます。
新たに管理ユーザーになって設定コマンドを実行すると、その内容はすぐに動作に反映されますが、 save コマンド
を実行しないと不揮発性メモリに書き込まれません。
注意  : ご購入直後の起動や cold start  後にはログインパスワードも管理パスワードも設定されていません。
セキュリティー上、ログインパスワードと管理パスワードの設定をお勧めします。
•ヤマハルーター  のご購入直後の起動でコンソールから各種の設定が行える状態になりますが、実際にパ
ケットを配送する動作は行いません。
•セキュリティーの設定や、詳細な各種パラメーターなどの付加的な設定に関しては、個々のネットワーク
の運営方針などに基づいて行ってください。
2.1.2 CONSOLE または  SERIAL ポートからの設定
ここでは、 Windows XP の『ハイパーターミナル』を使用する場合を例に説明します。シリアルケーブルの接続は事
前にすませておきます。
1.[スタート ]メニューから [マイコンピュータ ]を選び、 「システムのタスク」欄にある「システム情報を表示する」
を選びます。 「システムのプロパティ」ウィンドウが開いたら、 [ハードウェア ]タブを押します。32 | コマンドリファレンス  | コマンドの使い方

2.[デバイスマネージャ ]をクリックします。
「ポート  (COM と LPT)」アイコンをダブルクリックして開き、 「通信ポート」の「 COMx」という表現部分を調べ
ます。通常は「 COM1」の場合が多いでしょう。この  COM ポート番号は、手順  5 で必要になるために覚えてお
きます。
3.「デバイスマネージャ」ウィンドウを閉じます。
4.[スタート ]メニューから [すべてのプログラム ]-[アクセサリ ]-[通信 ]-[ハイパーターミナル ]を選びます。 「接続の設
定」ウィンドウが開いたら、名前欄に適切な名前を入力して [OK]をクリックします。
5.「接続方法」欄から、手順  2 で調べた  COM ポートを選択して [OK]をクリックします。コマンドリファレンス  | コマンドの使い方  | 33

6.「COMx のプロパティ」ウィンドウが開いたら、 [ビット /秒]を 9600、[データビット ]を 8、[パリティ ]をなし、 [ス
トップビット ]を 1、[フロー制御 ]を Xon/Xoff にして、 [OK]をクリックします。
7.「Password: 」と表示されたら、ログインパスワードを入力してから  Enter キーを押します。
※TELNET 複数セッション機能対応機種で設定した名前ありユーザでログインする場合は、何も入力せずに
Enter キーを押します。次に「 Username: 」と表示され、ユーザ名の入力待ち状態となります。ここで、設定した
ユーザ名を入力して  Enter キーを押し、続いてユーザパスワードを入力します。
何も表示されないときは、 1 度 Enter キーを押します。
「>」が表示されると、コンソールコマンドを入力できるようになります。
以下の例は、 RTX1200 にログインした場合の表示です。34 | コマンドリファレンス  | コマンドの使い方

注 :
•help と入力してから  Enter キーを押すと、キー操作の説明が表示されます。
•show command  と入力してから  Enter キーを押すと、コマンド一覧が表示されます。
8. administrator  と入力してから、 Enter キーを押します。
9.「Password: 」と表示されたら、管理パスワードを入力します。
「#」が表示されると、各種のコンソールコマンドを入力できます。
10.コンソールコマンドを入力して、設定を行います
11.設定が終わったら、 save と入力してから  Enter キーを押します。
コンソールコマンドで設定した内容が、本機の不揮発性メモリに保存されます。
12.設定を終了するには、 quit と入力してから  Enter キーを押します。
13.コンソール画面を終了するには、もう  1 度quit と入力してから  Enter キーを押します。
2.1.3 仮想マシンコンソールによる設定
仮想マシンコンソールは  vRX Amazon EC2 版 を除く  vRX シリーズ  で使用できます。ここでは、 vRX VMware ESXi
版 における設定手順の一例を説明します。
• vRX は、 VMware ESXi へデプロイし、起動まで済んでいる。
• vCenter Server はインストール済みで、デプロイした  vRX は管理対象となっている。
1.Webブラウザを開き、 VMware Vsphere を起動します。
2.ログイン画面が表示されたら、 ID@ドメインとパスワードを入力してからログインを押します。
画像の ID、ドメイン、パスワードは入力例です。
実際は接続先の  vCenter Server に対して権限があるユーザーの認証情報をご使用ください。コマンドリファレンス  | コマンドの使い方  | 35

3.「ホストおよびクラスタ」画面からデプロイ済みの  vRX を選択し、 「 Web コンソールの起動」を選択します。
4.「コンソールの起動」ポップアップが表示されるため、 「 Web コンソール」にチェック後、 OK を押します。36 | コマンドリファレンス  | コマンドの使い方

注 :
• VMware Remote Console を利用するには別途インストールが必要です。
5.「Password: 」と表示されたら、ログインパスワードを入力してから  Enter キーを押します。
※設定した名前ありユーザでログインする場合は、何も入力せずに  Enter キーを押します。次に「 Username: 」と
表示され、ユーザ名の入力待ち状態となります。ここで、設定したユーザ名を入力して  Enter キーを押し、続い
てユーザパスワードを入力します。
何も表示されないときは、 1 度 Enter キーを押します。 「 >」が表示されると、コンソールコマンドを入力できる
ようになります。
注 :
•help と入力してから  Enter キーを押すと、キー操作の説明が表示されます。
•show command  と入力してから  Enter キーを押すと、コマンド一覧が表示されます。
6. administrator  と入力してから、 Enter キーを押します。
7.「Password: 」と表示されたら、管理パスワードを入力します。
「#」が表示されると、各種のコンソールコマンドを入力できます。
8.コンソールコマンドを入力して、設定を行いますコマンドリファレンス  | コマンドの使い方  | 37

9.設定が終わったら、 save と入力してから  Enter キーを押します。
コンソールコマンドで設定した内容が、本機の不揮発性メモリに保存されます。
10.設定を終了するには、 quit と入力してから  Enter キーを押します。
11.仮想マシンコンソールでの操作を終了するには、もう  1 度 quit と入力してから  Enter キーを押します。
2.1.4 TELNET による設定
ここでは、 Windows の TELNET を使用する場合を例に説明します。ヤマハルーター  の IP アドレスは  198.51.100.1 と
した場合の例です。
Windows では、あらかじめ次の方法で  TELNET を有効にする必要があります。 「コントロールパネル」 -「プログラ
ム」 -「プログラムと機能」で、 「 Windows の機能の有効化または無効化」を選ぶと表示される「 Windows の機能」
画面で、 「 Telnet クライアント」にチェックを付けてから「 OK」をクリックします。
1.[スタート ]メニューから「 telnet 198.51.100.1 」と入力します。
実際には「 198.51.100.1 」のかわりに本機に設定されている  IP アドレスを入力します。
2.「Password: 」と表示されたら、ログインパスワードを入力してから  Enter キーを押します。
※TELNET 複数セッション機能対応機種で設定した名前ありユーザーでログインする場合は、何も入力せずに
Enter キーを押します。次に「 Username: 」と表示され、ユーザー名の入力待ち状態となります。ここで、設定し
たユーザー名を入力して  Enter キーを押し、続いてユーザーパスワードを入力します。
何も表示されないときは、 1 度 Enter キーを押します。 「 >」が表示されると、コンソールコマンドを入力できる
ようになります。38 | コマンドリファレンス  | コマンドの使い方

注 :
•help と入力してから  Enter キーを押すと、キー操作の説明が表示されます。
•show command  と入力してから  Enter キーを押すと、コマンド一覧が表示されます。
3. administrator  と入力してから、 Enter キーを押します。
4.「Password: 」と表示されたら、管理パスワードを入力します。
「#」が表示されると、各種のコンソールコマンドを入力できます。
5.コンソールコマンドを入力して、設定を行います
6.設定が終わったら、 save と入力してから  Enter キーを押します。
コンソールコマンドで設定した内容が、本機の不揮発性メモリに保存されます。
7.設定を終了するには、 quit と入力してから  Enter キーを押します。
8.コンソール画面を終了するには、もう  1 度 quit と入力してから  Enter キーを押します。
2.1.5 SSH による設定
ここでは、 Windows の SSH を使用する場合を例に説明します。ヤマハルーター  に設定されているユーザ名は
yamaha、IP アドレスは  198.51.100.1 とした場合の例です。
1.[スタート ]メニューから「 ssh yamaha@198.51.100.1 」と入力します。
実際には「 yamaha@198.51.100.1 」のかわりに本機に設定されているユーザ名 @IP アドレスと入力します。コマンドリファレンス  | コマンドの使い方  | 39

2.「Are you sure you want to continue connecting (yes/no)? 」と表示されたら、 「 yes」と入力してから  Enter キーを押しま
す。
「yamaha@198.51.100.1's password: 」と表示されたら、ログインパスワードを入力してから  Enter キーを押します。
何も表示されないときは、 1 度 Enter キーを押します。 「 >」が表示されると、コンソールコマンドを入力できる
ようになります。
注 :
•help と入力してから  Enter キーを押すと、キー操作の説明が表示されます。
•show command  と入力してから  Enter キーを押すと、コマンド一覧が表示されます。
3. administrator  と入力してから、 Enter キーを押します。
4.「Password: 」と表示されたら、管理パスワードを入力します。
「#」が表示されると、各種のコンソールコマンドを入力できます。
5.コンソールコマンドを入力して、設定を行います
6.設定が終わったら、 save と入力してから  Enter キーを押します。
コンソールコマンドで設定した内容が、本機の不揮発性メモリに保存されます。
7.設定を終了するには、 quit と入力してから  Enter キーを押します。
8.コンソール画面を終了するには、もう  1 度 quit と入力してから  Enter キーを押します。
2.1.6 リモートセットアップ
すでに  ヤマハルーター  をお使いの場合は、離れた場所のルーターでも  ISDN 回線や専用線経由で設定できます。こ
れを「リモートセットアップ」といいます。 ISDN 回線や専用線経由で相手のルーターに直接接続するので、プロバ
イダに契約していなくても、インターネット接続できない状態でも設定できます。40 | コマンドリファレンス  | コマンドの使い方

リモートセットアップを拒否するように設定できるため、拒否に設定しておけば、不特定の相手からの侵入を防げ
ます。
リモートセットアップはコンソールから行います。コンソールを使う方法は、前節の「 CONSOLE または  SERIAL
ポートからの設定」 または 「 TELNET による設定」 を参照してください。リモートセットアップのコマンドは remote
setup  です。
相手の  ヤマハルーター  へのログインが完了すると、設定したいルーターをコンソールコマンドで設定できるように
なります。
注意  :
•ヤマハルーター  以外のルーターからリモートセットアップすることはできません。
• FTTH や CATV、ADSL などの  WAN ポート経由で、リモートセットアップすることはできません。
2.2 SSH サーバーについて
SSH サーバー機能に対応した機種では、 LAN 上のホストから  SSH でログインして設定することができます。このと
きホスト側で使用する  SSH クライアントは、 macOS の『ターミナル』アプリケーションや  UNIX 環境では標準的に
搭載されており、実行することができますが、 Windows 系 OS では Windows 10 の version 1803 以前では標準で搭載
されていません。 SSH クライアントが搭載されていない環境では、フリーソフトなどで  SSH クライアント機能のあ
るものを用意してください。
2.2.1 SSH サーバー機能の使用に当たっての注意事項
SSH サーバー機能では以下の機能をサポートしていないことに注意してください。
• SSH プロトコルバージョン  1
•パスワード認証、公開鍵認証以外のユーザー認証  ( ホストベース認証、チャレンジ・レスポンス認証、 GSSAPI
認証  )
※以下の機種・リビジョンでは公開鍵認証をサポートしていません。
• RTX5000 / RTX3500 Rev.14.00.31 以降
• RTX1210 Rev.14.01.34 以前
• RTX830 Rev.15.02.13 以前
•ポートフォワーディング  (X11/TCP 転送  )
• Gateway Ports( ポート中継  )
•空パスワードの許可
2.2.2 SSH サーバーの設定
vRX Amazon EC2 版 では、デプロイ後の初期状態で  SSH サーバー機能を使用できます。ユーザー認証では、デプロ
イ時に指定したキーペアによる公開鍵認証が実施されます。
その他の機種では、工場出荷状態では  SSH サーバー機能を使用できません。 SSH サーバー機能を使用できるように
するまでの設定手順は以下の通りです。コマンドリファレンス  | コマンドの使い方  | 41

1. login user  コマンドで名前ありユーザを登録します。 SSH ではログイン時のユーザ名の入力が必須となるため、
事前に必ず名前ありユーザを登録しなければなりません。
2.次に、 sshd host key generate  コマンドで  SSH サーバーのホスト鍵を生成します。このコマンドによって  DSA ま
たは  RSA の公開鍵、および秘密鍵のペアが生成されます。ただし機種によってはこのコマンドの処理に数十秒
ほど時間がかかる場合があります。
3.最後に sshd service  コマンドで  SSH サーバー機能を有効にします。
2.3 TFTP について
ヤマハルーター  に設定した項目は、 TFTP により  LAN 上のホストから設定ファイルとして読み出すことができま
す。またホスト上の設定ファイルを本機に読み込ませて設定を行うこともできます。
TFTP は、 Windows やmacOS の『ターミナル』アプリケーション、 UNIX 環境で標準的に搭載されており、実行する
ことができます。 TFTP が搭載されていない環境では、フリーソフトなどで  TFTP クライアント機能のあるものを用
意してください。この時、ヤマハルーター  は TFTP サーバーとして動作します。
設定ファイルは全体の設定を記述したものであり、特定部分の設定だけを読み出したり差分点だけを書き込んだり
することはできません。設定ファイルは  Windows のメモ帳等で直接編集できるテキストファイル  ( シフト  JIS、
CRLF 改行  ) です。
TFTPでは、平文の設定ファイルと暗号化された設定ファイルを扱うことができます。対応している暗号化形式は、
AES128及び、 AES256です。パスワードを指定して暗号化されたファイルは利用できません。 RT-Tftp Client では暗
号化に対応していません。
注意  :
•設定ファイルの内容はコマンドの書式やパラメーターの指定などの内容が正しく記述されている必要が
あります。間違った書式や内容があった場合には、その内容は動作に反映されず無視されます。
• TFTP により設定ファイルを読み込む場合において  line type  コマンドのように再起動が必要な設定変更を
行う場合は、設定の最後に  restart  コマンドが必要なことに注意してください。
2.3.1 TFTP による設定手順
TFTP により設定ファイルをやりとりするためには、 ヤマハルーター  側にあらかじめアクセス許可するための設定が
必要です。まず tftp host  コマンドを使用し、本機にアクセスできるホストを設定します。工場出荷設定ではどのホ
ストからもアクセスできない設定になっていることに注意してください。42 | コマンドリファレンス  | コマンドの使い方

次に、 LAN 上のホストから  TFTP コマンドを実行します。使用するコマンドの形式は、そのホストの  OS に依存し
ます。次の点に注意して実行してください。
•本機の  IP アドレス
•転送モードは “アスキー ”、"ascii" または “文字 ”にします。
暗号化された設定ファイルを扱う場合は “バイナリ ”、"binary" にします。
•本機に管理パスワードが設定されている場合には、ファイル名称の後ろに管理パスワードを指定する必要があり
ます。
•起動中の設定ファイルを読み出したり書き込んだりする場合は、設定ファイル名は、 “config”と指定します。
2.3.2 設定ファイルの読み出し
ここでは、 Windows から設定ファイルを読み出す場合の例を示します。ヤマハルーターのコンソール操作ではない
ことに注意してください。この例では、ヤマハルーター  の IP アドレスを  198.51.100.1 、管理パスワードは “himitsu” 、
Windows に新しくできるファイルの名称を “OLDconfig.txt” とします。
1.[スタート ]メニューから [Windows システム  ツール ]-[コマンド  プロンプト ]を選びます。
2.設定ファイルを保存するディレクトリに移動します。
3. tftp 198.51.100.1 get config/himitsu OLDconfig.txt  と入力してから、 Enter キーを押します。
設定ファイルを暗号化して読み出す場合は、 ファイル名の後に "-encryption" オプションを指定します。暗号化形式
を指定する場合は、 "-encryption" の後に "-aes128" または "-aes256" をオプションを指定します。暗号化形式を省略し
た場合は、 AES256が暗号化形式として使用されます。暗号化形式を AES128として設定ファイルを暗号化して
読み出す場合は、
tftp -i 198.51.100.1 get config-encryption-aes128/himitsu OLDconfig.txt
と入力してから、 Enterキーを押します
2.3.3 設定ファイルの書き込み
ここでは、 Windows から設定ファイルを書き込む場合の例を示します。ヤマハルーター  のコンソール操作ではない
ことに注意してください。この例では、ヤマハルーター  の IP アドレスを  198.51.100.1 、管理パスワードは “himitsu” 、
書き込むべき Windows 上のファイルの名称を “NEWconfig.txt” とします。
1.[スタート ]メニューから [Windows システム  ツール ] - [コマンド  プロンプト ]を選びます。
2.設定ファイルを保存するディレクトリに移動します。コマンドリファレンス  | コマンドの使い方  | 43

3. tftp 198.51.100.1 put NEWconfig.txt config/himitsu と入力してから、 Enter キーを押します。
暗号化された設定されたファイル "NEWconfig.rtfg" を設定ファイルに書き込む場合は、 通常の設定ファイルの書き
込みと同様に、
tftp -i 198.51.100.1 put NEWconfig.rtfg config/himitsu
と入力してから、 Enter キーを押します。
2.4 コンソール使用時のキーボード操作について
一画面に収まらない行数の情報を表示する場合は、 console lines  コマンドで設定された行数分を表示した段階で表示
をストップさせ、画面下に「 --- つづく  ---」と表示されます。
この状態から残りを表示させる場合には、スペースキーを押します。 Enter キーを押すと新しい一行を表示します。
これらの操作を繰り返し、最後まで表示すると自動的にコマンド入力ができる状態にもどります。
最後まで表示せずにこの段階で表示を終了させたい場合には、 q キーを押します。この後コマンドが入力できる状態
にもどります。
一画面に収まらない行数の情報を表示する場合にもストップさせたくなければ、 console lines infinity  コマンドを実
行します。
キーボード操作 説明・備考
SPACE 1 画面先に進める
ENTER
1 行先に進める
RETURN
q
終了
Ctrl-C
show config 、show config list 、show config pp 、show config tunnel 、show config switch 、show config ap 、show file
list、show log  と同じ内容を、 UNIX コマンドの less 風に表示する場合には、それぞれ、 less config 、less config list 、
less config pp 、less config tunnel 、less config switch 、less config ap 、less file list 、less log  コマンドを使用します。
キーボード操作 説明・備考
{n} f
{n}画面先に進める {n} Ctrl-F
{n} SPACE
{n} b
{n}画面後ろに戻す
{n} Ctrl-B44 | コマンドリファレンス  | コマンドの使い方

キーボード操作 説明・備考
{n} j
{n}行先に進める{n} Ctrl-J
{n} Ctrl-E
{n} Ctrl-M
{n} ENTER
{n} RETURN
{n} k
{n}行後ろに戻す{n} Ctrl-K
{n} y
{n} Ctrl-Y
{n} Ctrl-P
{n} d
{n}半画面先に進める
{n} Ctrl-D
{n} u
{n}半画面後ろに戻す
{n} Ctrl-U
{n} g{n}行目へ移動
{n]省略時は先頭行
{n} G{n}行目へ移動
{n]省略時は末尾行
{n} r
現在の画面の書き直し {n} Ctrl-R
{n} Ctrl-L
q
終了
Ctrl-C
説明  :
• n: 数字のキー入力で整数値を表します。省略時は  '1' です。
• Ctrl-X:[Ctrl] キーを押しながら [X]キーを押すことを示します。
2.5 「show」で始まるコマンド
「show」で始まるコマンドが表示する内容から、指定した検索パターンに一致する内容だけを抜き出して表示するこ
とができます。あるいは「 show」で始まるコマンドが表示する内容をページ単位で表示しながら、後ろに戻ったり、
指定した検索パターンに一致する内容を検索したりすることができます。
これらの機能は「 show」で始まるすべてのコマンドで利用できます。
2.5.1 show コマンドの表示内容から検索パターンに一致する内容だけを抜き出す
[書式 ]
show  [...] | grep  [-i] [-v] [-w] pattern
[設定値及び初期値 ]
• -i : pattern  中の英大文字  / 小文字を区別せず検索する
• [初期値 ] : -
• -v : pattern  に一致しなかった行を表示する
• [初期値 ] : -コマンドリファレンス  | コマンドの使い方  | 45

• -w : pattern  が単語に一致する時だけ表示する
• [初期値 ] : -
•pattern
• [設定値 ] : 検索パターン
• [初期値 ] : -
[説明 ]
show  コマンドの表示内容から検索パターンである pattern  に一致する行だけを抜き出して表示する。
-i オプションを指定した時には、 pattern  中の英大文字 / 小文字を区別せずに検索する。例えば  -i オプションがある時
には  'abc' という pattern  は 'abc' や 'ABC'、'aBc'、'ABc' などに一致する。一方、 -i オプションがなければ、 'abc' は 'abc'
としか一致しない。
-v オプションを指定した時には、 pattern  に一致しない行を表示する。
-w オプションを指定した時には、 pattern  に一致するのは単語だけとなる。例えば、 -w オプションがある時には  'IP'
という pattern  は 'IPv4' や 'IPv6' とは一致しないが、 ' IP '( 前後に空白がある  ) や '[IP]' には一致する。一方、 -w オプシ
ョンが無ければ先に上げた例にはすべて一致する。
pattern  は限定された正規表現である。一般的な正規表現では多くの特殊文字を使って多様な検索パターンを構成で
きるが、ここで実装されているのは以下の特殊文字のみである。
文字 意味 使用例 一致する文字列の例
. 任意の  1 文字に一致する a.b aab、aXb、a-b
?直前の文字が  0 回または  1
回出現するパターンに一致
するb?c ac、abc
*直前の文字が  0 回以上繰り
返すパターンに一致するab*c ac、abc、abbc、abbbbbbbbc
+直前の文字が  1 回以上繰り
返すパターンに一致するab+c abc、abbc、abbbbbbbbc
|前後の文字のいずれかに一
致するab|cd abd、acd
[ ][ ] 内の文字のいずれかに
一致するa[bc]d abd、acd
[^ ][ ] 内の文字以外のものに
一致するa[^bc]d aad、axd
^ 行の先頭に一致する ^abc abc で始まる行
$ 行の末尾に一致する abc$ abc で終わる行
( )文字列などをグループとし
て扱う(ab|cd) ab、cd
\続く特殊文字の効果を打ち
消すa\.c a.c
また、 grep  は一行に繰り返し指定することもできる。更に、 less コマンドと同時に使用することもできる。
pattern  中の文字として  '\','?',' |' を使用する場合は、それらの文字の前に  '\' をもう一つ重ねて入力しなければならな
い。
コマンド実行時に  "Searching ..." と表示され、対象文字列の検索中に  Ctrl＋C を入力すると表示を中止できる。
例 )
# show command | grep nat
Searching ...
clear nat descriptor dynamic: 動的な  NAT 情報を削除します
^C
#46 | コマンドリファレンス  | コマンドの使い方

[設定例 ]
show config | grep ip | grep lan
show config | grep ip | less
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
2.5.2 show コマンドの表示内容を見やすくする
[書式 ]
show  [...] | less
[説明 ]
show  コマンドの表示内容を  1 画面単位で表示し、最終行でコマンドを受け付ける。
表示内容が  1 画面に満たない場合には、すべての内容を表示して終了する。
コマンドは、数値プレフィクスとコマンド文字を入力することで実行される。数値プレフィクスはオプションで省
略できる。数値プレフィクスを省略した場合には  1 と見なされる。検索コマンドでは、コマンド文字の後に検索文
字列を入力できる。
コマンドには以下の種類がある。
コマンド 内容  ( 数値プレフィックスを  N とする  )
q less を終了する。
スペース N 画面先に進む。
b N 画面後ろに戻る。
j、ENTER N 行先に進む。
k N 行後ろに戻る。
g N 行目にジャンプする。
GN 行目にジャンプする。ただし、数値プレフィクスを省
略した時には、最終行にジャンプする。
/コマンド文字後に入力された検索パターンを前方に検
索する。検索パターンは  grep コマンドと同じものであ
る。
?コマンド文字後に入力された検索パターンを後方に検
索する。検索パターンは  grep コマンドと同じものであ
る。
n最後に入力された /、あるいは ?と同じ検索パターンで同
じ方向に検索する。
N最後に入力された /、あるいは ?と同じ検索パターンで逆
方向に検索する。
[適用モデル ]
vRX シリーズ , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210, RTX840, RTX830
2.5.3 外部メモリまたはストレージへのリダイレクト機能
[書式 ]
show  [...] > name
show  [...] >> name
[設定値及び初期値 ]
•name  : ファイル名
• [設定値 ] :コマンドリファレンス  | コマンドの使い方  | 47

設定値 説明
usb1: filename  （filename  は半角  99 文字以内） USB メモリ内のファイル  （filename  は半角  99 文字以
内）
sd1:filename microSD カード内のファイル
prefix :path 外部ストレージ内のファイル （ prefix  には  mount  コマ
ンドで設定したプレフィックスを指定する）
• [初期値 ] : -
[説明 ]
show  コマンドの実行結果を外部メモリまたはストレージに保存させることができる。
保存ファイルの暗号化には対応していない。
パイプ  ( '|') と併用することで必要な行のみをファイルとして保存させることができる。
# show log | grep IKE > usb1:log.txt
また、外部メモリまたはストレージの既存ファイルに対してリダイレクト記号  '>>' を使用することで、コマンドの
実行結果を既存ファイルに追加できる。
# show log > usb1:log.txt          ... 新規ファイル
# show log >> usb1:( 既存 )log.txt ... ファイルの末尾に追加
また、リダイレクト記号 ‘>’を使用し、出力先ファイルに既存ファイル名を指定すると、ファイルを上書きしてよい
かの確認メッセージが表示される。
# show log > usb1:( 既存 )log.txt
# 指定したファイルは既に存在しています。上書きしますか ? (Y/N)
ただし、外部ストレージ内のファイルを指定した場合や、 GUIのコマンド入力ページ、カスタム GUI、Luaの
rt.command から実行した場合は確認メッセージが表示されず、強制的に上書きされる。
[ノート ]
外部メモリは、 vRX シリーズ  では使用不可能。
外部ストレージは、 vRX シリーズ  で使用可能。
リダイレクトの後にパイプ  ( '|') は指定できない。
リダイレクトを複数回指定できない。
show  以外から始まるコマンド、 less から始まるコマンドは適用外となる。
外部メモリについて、以下の状態では本機能は実行できない。
•接続されていない状態
•ボタンを押された状態
•使用を禁止されている状態
外部メモリの容量が不足している場合、書き込みに成功したサイズ分のファイルが生成される。外部ストレージの
容量が不足している場合、書き込みに成功したサイズ分のファイルが生成される。
[設定例 ]
show log  の内容を  USB メモリに保存
# show log > usb1:log.txt
show techinfo  の内容を  microSD カードに保存
# show techinfo > sd1:techinfo.txt
[適用モデル ]
vRX VMware ESXi 版, vRX さくらのクラウド版 , RTX5000, RTX3510, RTX3500, RTX1300, RTX1220, RTX1210,
RTX840, RTX83048 | コマンドリファレンス  | コマンドの使い方

