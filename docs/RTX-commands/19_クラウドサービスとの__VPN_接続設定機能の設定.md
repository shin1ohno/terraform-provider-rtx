# 第19章: クラウドサービスとの  VPN 接続設定機能の設定

> 元PDFページ: 355-359

---

第 19 章
クラウドサービスとの  VPN 接続設定機能の設定
クラウドサービスと  VPN 接続するためのヤマハルーターの設定を、かんたんに行うための機能です。
本機能を利用することで、インターネットのゲートウェイにしているヤマハルーターと、クラウドサービスの仮想
ネットワークとをかんたんに  VPN 接続することができます。
本機能を使用するためには、事前にクラウドサービス側の設定をしておく必要があります。
接続するクラウドサービスとして選べるサービスは以下の URLを参照してください。
• https://www.rtpro.yamaha.co.jp/RT/docs/cloud_vpn/
19.1 VPN 接続するクラウドサービスの指定
[書式 ]
cloud  vpn service  id service_name
no cloud  vpn service  id [service_name ]
[設定値及び初期値 ]
•id
• [設定値 ] : クラウド設定番号  (1..3)
• [初期値 ] : -
•service_name
• [設定値 ] :
設定値 説明
amazon-api API を用いた  Amazon VPC との接続設定
• [初期値 ] : -
[説明 ]
VPN 接続するクラウドサービスを指定する。
[ノート ]
RTX1210 は Rev.14.01.20 以降で使用可能。
[適用モデル ]
RTX3510, RTX1300, RTX1220, RTX1210, RTX840, RTX830
19.2 クラウドサービスとの  VPN 接続設定に必要なパラメーターの設定
[書式 ]
cloud  vpn parameter  id parameter  [parameter  [parameter ]]
no cloud  vpn parameter  id [parameter  ...]
[設定値及び初期値 ]
•id
• [設定値 ] : クラウド設定番号  (1..3)
• [初期値 ] : -
•parameter
• [設定値 ] : パラメーター  ( 半角  256 文字以内  )
• [初期値 ] : -
[説明 ]
クラウドサービスとの  VPN 接続設定に必要なパラメーターを設定する。
Amazon VPC との  VPN 接続を行う場合、次の順番で parameter に指定する。これらの情報は、事前に  AWS の管理画
面で設定しておく必要がある。コマンドリファレンス  | クラウドサービスとの  VPN 接続設定機能の設定  | 355

1.アクセスキー  ID
2.シークレットアクセスキー
3.VPN ID
[ノート ]
RTX1210 は Rev.14.01.20 以降で使用可能。
[設定例 ]
Amazon VPC との  VPN 接続を行う場合
cloud vpn parameter 1 abcdefghij ABCDEFGHIJKLM vpn-01234567
[適用モデル ]
RTX3510, RTX1300, RTX1220, RTX1210, RTX840, RTX830
19.3 クラウドサービスとの  VPN 接続設定の名称の設定
[書式 ]
cloud  vpn name  id name
no cloud  vpn name  id [name ]
[設定値及び初期値 ]
•id
• [設定値 ] : クラウド設定番号  (1..3)
• [初期値 ] : -
•name
• [設定値 ] : クラウド設定の名称  ( 半角  32 文字以内  )
• [初期値 ] : -
[説明 ]
クラウドサービスとの  VPN 接続設定の名称を設定する。
nameに指定した名称は、 設定を取得したときに自動的に設定される tunnel description  コマンドの文字列に反映され
る。
[ノート ]
RTX1210 は Rev.14.01.20 以降で使用可能。
[適用モデル ]
RTX3510, RTX1300, RTX1220, RTX1210, RTX840, RTX830
19.4 クラウドサービスとの  VPN 接続を設定するトンネルインターフェースの指定
[書式 ]
cloud  vpn bind  id tunnel_if1  [tunnel_if2 ]
no cloud  vpn bind  id [tunnel_if1  ...]
[設定値及び初期値 ]
•id
• [設定値 ] : クラウド設定番号  (1..3)
• [初期値 ] : -
•tunnel_if1, tunnel_if2
• [設定値 ] : トンネルインターフェース番号
• [初期値 ] : -
[説明 ]
クラウドサービスとの  VPN 接続を設定するトンネルインターフェースを指定する。356 | コマンドリファレンス  | クラウドサービスとの  VPN 接続設定機能の設定

本コマンドを事前に設定した場合、指定したトンネルインターフェースにクラウドサービスとの  VPN 接続を設定す
る。
Amazon VPC との  VPN 接続設定を行う場合、トンネルインターフェースを 2つ指定する必要がある。
本コマンドを設定していない状態で、クラウドサービスから設定値を取得した場合、使用していないトンネルイン
ターフェースを検索して自動的に設定する。
[ノート ]
RTX1210 は Rev.14.01.20 以降で使用可能。
[適用モデル ]
RTX3510, RTX1300, RTX1220, RTX1210, RTX840, RTX830
19.5 クラウドサービスとの  VPN 接続設定に使用するオプションの設定
[書式 ]
cloud  vpn option  id option =value
no cloud  vpn option  id [option =value ]
[設定値及び初期値 ]
•id
• [設定値 ] : クラウド設定番号  (1..3)
• [初期値 ] : -
•option=value
• [設定値 ] :
option value 説明
region リージョンAmazon VPC のインスタンスを生
成したリージョン  ( 半角  32 文字以
内 )
• [初期値 ] :
• region=ap-northeast-1
[説明 ]
クラウドサービスとの  VPN 接続設定に使用するオプションを設定する。
region には、 Amazon VPC のインスタンスを生成したリージョンを設定する。初期値は  ap-northeast-1 で、アジアパ
シフィック  (東京 ) のリージョンである。 Amazon VPC のリージョン名、およびリージョンについては以下の URLを
参照のこと。
• https://www.rtpro.yamaha.co.jp/RT/docs/cloud_vpn/amazon-vpc_api.html
[ノート ]
RTX1210 は Rev.14.01.20 以降で使用可能。
[適用モデル ]
RTX3510, RTX1300, RTX1220, RTX1210, RTX840, RTX830
19.6 クラウドサービスとの  VPN 接続設定の手動実行
[書式 ]
cloud  vpn set go id [option ]
[設定値及び初期値 ]
•id
• [設定値 ] : クラウド設定番号  (1..3)
• [初期値 ] : -
•option
• [設定値 ] :コマンドリファレンス  | クラウドサービスとの  VPN 接続設定機能の設定  | 357

設定値 説明
save 生成した  CONFIG を保存する
no-save 生成した  CONFIG を保存しない
• [初期値 ] : -
[説明 ]
クラウドサービスとの  VPN 接続設定を実行する。
クラウドサービスから取得した設定値を基に、クラウドサービスとの  VPN 接続を行うための  CONFIG を生成し、
VPN 接続する。
optionを省略した場合、クラウドサービスとの  VPN 接続設定が完了すると、設定を保存するか否か  (Y/N) の問い合
わせを表示する。 Y を入力すると設定を保存し、 N を入力すると設定を保存しない。
Web GUI でのコマンド実行やスケジュール実行、 Lua スクリプトなど、対話型の入力ができない場合、 optionは必ず
指定する必要がある。
[ノート ]
本コマンドを実行して手動で設定値を取得する場合、リトライは行わない。
RTX1210 は Rev.14.01.20 以降で使用可能。
[設定例 ]
# cloud vpn set go 1
................
クラウドサービスとの  VPN 接続設定が完了しました。
設定を保存しますか？  (Y/N) 
[適用モデル ]
RTX3510, RTX1300, RTX1220, RTX1210, RTX840, RTX830
19.7 クラウドサービスとの  VPN 接続設定の状態の表示
[書式 ]
show  status  cloud  vpn [id]
[設定値及び初期値 ]
•id
• [設定値 ] : クラウド設定番号  (1..3)
• [初期値 ] : -
[説明 ]
クラウドサービスとの  VPN 接続設定の状態を表示する。
•設定名
•ステータス（設定取得状況）
• CONFIG の更新日時
•設定情報の最終取得日時
•トンネルの接続状態
ID を省略すると、設定されているすべてのクラウドサービスとの  VPN 接続設定の状態を表示する。
[ノート ]
RTX1210 は Rev.14.01.20 以降で使用可能。
[表示例 ]
# show status cloud vpn 1
クラウド設定 [1]
サービス名 :              Amazon(API 方式)
設定名 :                  yamaha            # cloud vpn name コマンドの設定値
ステータス :              設定済み358 | コマンドリファレンス  | クラウドサービスとの  VPN 接続設定機能の設定

最終取得日時 :            2017/01/25 10:11:22
CONFIG の更新日時 :        2017/01/24 12:00:00
TUNNEL の接続状態 :
  TUNNEL[01]: 接続されています
  TUNNEL[02]: 接続されています
[適用モデル ]
RTX3510, RTX1300, RTX1220, RTX1210, RTX840, RTX830
19.8 クラウドサービス接続時の詳細情報を  SYSLOG に表示
[書式 ]
cloud  vpn syslog  sw
no cloud  vpn syslog  [sw]
[設定値及び初期値 ]
•sw
• [設定値 ] :
設定値 説明
on クラウドサービス接続時の詳細情報を  SYSLOG に表
示する
off クラウドサービス接続時の詳細情報を  SYSLOG に表
示しない
• [初期値 ] : off
[説明 ]
クラウドサービス接続時の詳細情報を  SYSLOG に表示する。
[ノート ]
RTX1210 は Rev.14.01.34 以降で使用可能。
RTX830 は Rev.15.02.10 以降で使用可能。
[適用モデル ]
RTX3510, RTX1300, RTX1220, RTX1210, RTX840, RTX830コマンドリファレンス  | クラウドサービスとの  VPN 接続設定機能の設定  | 359

