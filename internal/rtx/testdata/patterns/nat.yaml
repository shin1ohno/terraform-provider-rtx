# NAT Command Patterns for Yamaha RTX Routers
# Reference: RTX Command Reference Chapter 23

category: nat
chapter: 23
parser: nat_masquerade.go, nat_static.go

commands:
  # 23.3 NAT Descriptor Type
  - name: nat descriptor type
    syntax: "nat descriptor type <nat_descriptor> <type> [hairpin=<sw>]"
    no_form: "no nat descriptor type <nat_descriptor>"
    chapter: 23
    section: "23.3"
    parser: nat_masquerade.go
    description: Set the operation type for NAT descriptor
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: type
        type: enum
        required: true
        values: [none, nat, masquerade, nat-masquerade]
        description: |
          NAT operation type:
          - none: No NAT conversion
          - nat: Dynamic and static NAT conversion
          - masquerade: Static NAT and IP masquerade conversion
          - nat-masquerade: Dynamic NAT, static NAT, and IP masquerade conversion
      - name: sw
        type: enum
        required: false
        values: [on, off]
        default: "off"
        description: Enable/disable hairpin NAT feature
    examples:
      - input: "nat descriptor type 1 masquerade"
        expected:
          descriptor_id: 1
          type: masquerade
        description: Basic masquerade NAT
      - input: "nat descriptor type 100 nat"
        expected:
          descriptor_id: 100
          type: nat
        description: Dynamic NAT type
      - input: "nat descriptor type 2 masquerade hairpin=on"
        expected:
          descriptor_id: 2
          type: masquerade
          hairpin: on
        description: Masquerade NAT with hairpin enabled
      - input: "nat descriptor type 10 nat-masquerade"
        expected:
          descriptor_id: 10
          type: nat-masquerade
        description: Combined NAT and masquerade type
      - input: "nat descriptor type 5 static"
        expected:
          descriptor_id: 5
          type: static
        description: Static NAT type

  # 23.4 NAT Outer Address
  - name: nat descriptor address outer
    syntax: "nat descriptor address outer <nat_descriptor> <outer_ipaddress_list>"
    no_form: "no nat descriptor address outer <nat_descriptor>"
    chapter: 23
    section: "23.4"
    parser: nat_masquerade.go
    description: Set the outer (external) IP address for NAT processing
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: outer_ipaddress_list
        type: string
        required: true
        description: |
          Outer IP address list or mnemonic:
          - IP address: Single IP or range with hyphen (e.g., 192.168.1.1-192.168.1.10)
          - ipcp: IP address obtained via PPP IPCP
          - primary: IP address from ip interface address command
          - secondary: IP address from ip interface secondary address command
          - map-e: Auto-generated MAP-E IP address
          - hb46pp: IP address from IPv6 migration provisioning
    examples:
      - input: "nat descriptor address outer 1 ipcp"
        expected:
          descriptor_id: 1
          outer_address: ipcp
        description: Use PPPoE assigned address as outer
      - input: "nat descriptor address outer 1 203.0.113.1"
        expected:
          descriptor_id: 1
          outer_address: "203.0.113.1"
        description: Specific outer IP address
      - input: "nat descriptor address outer 2 203.0.113.1-203.0.113.16"
        expected:
          descriptor_id: 2
          outer_address: "203.0.113.1-203.0.113.16"
        description: Outer IP address range
      - input: "nat descriptor address outer 1 primary"
        expected:
          descriptor_id: 1
          outer_address: primary
        description: Use primary interface address

  # 23.5 NAT Inner Address
  - name: nat descriptor address inner
    syntax: "nat descriptor address inner <nat_descriptor> <inner_ipaddress_list>"
    no_form: "no nat descriptor address inner <nat_descriptor>"
    chapter: 23
    section: "23.5"
    parser: nat_masquerade.go
    description: Set the inner (internal) IP address range for NAT/IP masquerade processing
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: inner_ipaddress_list
        type: string
        required: true
        description: |
          Inner IP address list or mnemonic:
          - IP address: Single IP or range with hyphen
          - auto: All addresses (default)
    examples:
      - input: "nat descriptor address inner 1 192.168.1.0-192.168.1.255"
        expected:
          descriptor_id: 1
          inner_network: "192.168.1.0-192.168.1.255"
        description: Specify inner network range
      - input: "nat descriptor address inner 1 auto"
        expected:
          descriptor_id: 1
          inner_network: auto
        description: Allow all internal addresses
      - input: "nat descriptor address inner 2 192.168.0.1-192.168.0.100"
        expected:
          descriptor_id: 2
          inner_network: "192.168.0.1-192.168.0.100"
        description: Specific host range

  # 23.6 Static NAT Entry
  - name: nat descriptor static
    syntax: "nat descriptor static <nat_descriptor> <id> <outer_ip>=<inner_ip> [<count>]"
    no_form: "no nat descriptor static <nat_descriptor> <id>"
    chapter: 23
    section: "23.6"
    parser: nat_static.go
    description: Set static NAT mapping (1:1 address translation)
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: id
        type: int
        required: true
        range: "1-2147483647"
        description: Static NAT entry identifier
      - name: outer_ip
        type: ipv4
        required: true
        description: Outer (external) IP address
      - name: inner_ip
        type: ipv4
        required: true
        description: Inner (internal) IP address
      - name: count
        type: int
        required: false
        default: 1
        description: Number of consecutive addresses to map
    examples:
      - input: "nat descriptor static 1 1 203.0.113.10=192.168.1.10"
        expected:
          descriptor_id: 1
          entry_id: 1
          outside_global: "203.0.113.10"
          inside_local: "192.168.1.10"
        description: Basic 1:1 static NAT mapping
      - input: "nat descriptor static 2 1 203.0.113.100=192.168.0.100 10"
        expected:
          descriptor_id: 2
          entry_id: 1
          outside_global: "203.0.113.100"
          inside_local: "192.168.0.100"
          count: 10
        description: Map 10 consecutive addresses

  # 23.6 Static NAT Entry with Netmask
  - name: nat descriptor static netmask
    syntax: "nat descriptor static <nat_descriptor> <id> <outer_ip>=<inner_ip>/<netmask>"
    no_form: "no nat descriptor static <nat_descriptor> <id>"
    chapter: 23
    section: "23.6"
    parser: nat_static.go
    description: Set static NAT mapping with netmask for network translation
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: id
        type: int
        required: true
        range: "1-2147483647"
        description: Static NAT entry identifier
      - name: outer_ip
        type: ipv4
        required: true
        description: Outer (external) network address
      - name: inner_ip
        type: ipv4
        required: true
        description: Inner (internal) network address
      - name: netmask
        type: string
        required: true
        description: Netmask in dotted decimal, hex (0x...), or CIDR prefix length (16-32)
    examples:
      - input: "nat descriptor static 1 1 203.0.113.0=192.168.1.0/24"
        expected:
          descriptor_id: 1
          entry_id: 1
          outside_global: "203.0.113.0"
          inside_local: "192.168.1.0"
          netmask: "24"
        description: Static NAT for /24 network

  # 23.8 Static IP Masquerade Entry
  - name: nat descriptor masquerade static
    syntax: "nat descriptor masquerade static <nat_descriptor> <id> <inner_ip> <protocol> [<outer_port>=]<inner_port>"
    no_form: "no nat descriptor masquerade static <nat_descriptor> <id>"
    chapter: 23
    section: "23.8"
    parser: nat_masquerade.go
    description: Set static IP masquerade entry (port forwarding)
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: id
        type: int
        required: true
        description: Static IP masquerade entry identifier
      - name: inner_ip
        type: ipv4
        required: true
        description: Inner (internal) IP address
      - name: protocol
        type: enum
        required: true
        values: [tcp, udp, icmp, esp]
        description: Protocol (tcp, udp, icmp, esp, or protocol number)
      - name: outer_port
        type: port
        required: false
        description: Fixed outer port number (if different from inner)
      - name: inner_port
        type: port
        required: true
        description: Fixed inner port number
    examples:
      - input: "nat descriptor masquerade static 1 1 192.168.1.100 tcp 80"
        expected:
          descriptor_id: 1
          entry_number: 1
          inside_local: "192.168.1.100"
          protocol: tcp
          inside_local_port: 80
        description: Port forwarding HTTP to internal server (same port)
      - input: "nat descriptor masquerade static 1 2 192.168.1.100 tcp 8080=80"
        expected:
          descriptor_id: 1
          entry_number: 2
          inside_local: "192.168.1.100"
          protocol: tcp
          outside_global_port: 8080
          inside_local_port: 80
        description: Port forwarding external 8080 to internal 80
      - input: "nat descriptor masquerade static 1 3 192.168.1.200 udp 53"
        expected:
          descriptor_id: 1
          entry_number: 3
          inside_local: "192.168.1.200"
          protocol: udp
          inside_local_port: 53
        description: Port forwarding DNS to internal server

  # 23.2 Interface NAT Descriptor
  - name: ip interface nat descriptor
    syntax: "ip <interface> nat descriptor <nat_descriptor_list> [reverse <nat_descriptor_list>]"
    no_form: "no ip <interface> nat descriptor"
    chapter: 23
    section: "23.2"
    parser: nat_masquerade.go
    description: Apply NAT descriptor to LAN interface
    parameters:
      - name: interface
        type: interface
        required: true
        description: LAN or WAN interface name
      - name: nat_descriptor_list
        type: string
        required: true
        description: Space-separated NAT descriptor numbers (up to 16)
      - name: reverse_nat_descriptor_list
        type: string
        required: false
        description: NAT descriptors for reverse direction processing
    examples:
      - input: "ip lan1 nat descriptor 1"
        expected:
          interface: lan1
          descriptor_id: 1
        description: Apply NAT descriptor 1 to lan1
      - input: "ip lan2 nat descriptor 1 2 3"
        expected:
          interface: lan2
          descriptor_ids: [1, 2, 3]
        description: Apply multiple NAT descriptors

  # 23.2 PP Interface NAT Descriptor
  - name: ip pp nat descriptor
    syntax: "ip pp nat descriptor <nat_descriptor_list> [reverse <nat_descriptor_list>]"
    no_form: "no ip pp nat descriptor"
    chapter: 23
    section: "23.2"
    parser: nat_masquerade.go
    description: Apply NAT descriptor to PP (Point-to-Point) interface
    parameters:
      - name: nat_descriptor_list
        type: string
        required: true
        description: Space-separated NAT descriptor numbers (up to 16)
      - name: reverse_nat_descriptor_list
        type: string
        required: false
        description: NAT descriptors for reverse direction processing
    examples:
      - input: "ip pp nat descriptor 1"
        expected:
          descriptor_id: 1
        description: Apply NAT descriptor 1 to PP interface
      - input: "ip pp nat descriptor 1 2"
        expected:
          descriptor_ids: [1, 2]
        description: Apply multiple NAT descriptors to PP interface

  # 23.2 Tunnel Interface NAT Descriptor
  - name: ip tunnel nat descriptor
    syntax: "ip tunnel nat descriptor <nat_descriptor_list> [reverse <nat_descriptor_list>]"
    no_form: "no ip tunnel nat descriptor"
    chapter: 23
    section: "23.2"
    parser: nat_masquerade.go
    description: Apply NAT descriptor to tunnel interface
    parameters:
      - name: nat_descriptor_list
        type: string
        required: true
        description: Space-separated NAT descriptor numbers (up to 16)
      - name: reverse_nat_descriptor_list
        type: string
        required: false
        description: NAT descriptors for reverse direction processing
    examples:
      - input: "ip tunnel nat descriptor 1"
        expected:
          descriptor_id: 1
        description: Apply NAT descriptor to tunnel interface

  # 23.9 NAT Timer
  - name: nat descriptor timer
    syntax: "nat descriptor timer <nat_descriptor> <time>"
    no_form: "no nat descriptor timer <nat_descriptor>"
    chapter: 23
    section: "23.9"
    parser: nat_masquerade.go
    description: Set NAT session timeout timer
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: time
        type: int
        required: true
        range: "30-21474836"
        default: 900
        description: Timeout in seconds
    examples:
      - input: "nat descriptor timer 1 3600"
        expected:
          descriptor_id: 1
          timer: 3600
        description: Set NAT timeout to 1 hour

  # 23.9 NAT Timer Protocol-specific
  - name: nat descriptor timer protocol
    syntax: "nat descriptor timer <nat_descriptor> protocol=<protocol> [port=<port_range>] <time>"
    no_form: "no nat descriptor timer <nat_descriptor> protocol=<protocol>"
    chapter: 23
    section: "23.9"
    parser: nat_masquerade.go
    description: Set protocol-specific NAT session timeout
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: protocol
        type: string
        required: true
        description: Protocol name or number
      - name: port_range
        type: port_range
        required: false
        description: Port range (for TCP/UDP only)
      - name: time
        type: int
        required: true
        range: "30-21474836"
        description: Timeout in seconds
    examples:
      - input: "nat descriptor timer 1 protocol=udp 300"
        expected:
          descriptor_id: 1
          protocol: udp
          timer: 300
        description: Set UDP NAT timeout to 5 minutes

  # 23.9 NAT Timer TCP FIN
  - name: nat descriptor timer tcpfin
    syntax: "nat descriptor timer <nat_descriptor> tcpfin <time>"
    no_form: "no nat descriptor timer <nat_descriptor> tcpfin"
    chapter: 23
    section: "23.9"
    parser: nat_masquerade.go
    description: Set NAT session timeout after TCP FIN
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: time
        type: int
        required: true
        range: "1-21474836"
        default: 60
        description: Timeout in seconds after TCP FIN
    examples:
      - input: "nat descriptor timer 1 tcpfin 30"
        expected:
          descriptor_id: 1
          tcpfin_timer: 30
        description: Set TCP FIN timeout to 30 seconds

  # 23.10 Masquerade Incoming Action
  - name: nat descriptor masquerade incoming
    syntax: "nat descriptor masquerade incoming <nat_descriptor> <action> [<ip_address>]"
    no_form: "no nat descriptor masquerade incoming <nat_descriptor>"
    chapter: 23
    section: "23.10"
    parser: nat_masquerade.go
    description: Set action for incoming packets without matching NAT entry
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: action
        type: enum
        required: true
        values: [through, reject, discard, forward]
        default: reject
        description: |
          Action for unmatched incoming packets:
          - through: Pass through without translation (RST for TCP/0-1023)
          - reject: Discard and return nothing (RST for TCP/0-1023)
          - discard: Silently discard
          - forward: Forward to specified IP address
      - name: ip_address
        type: ipv4
        required: false
        description: Forward destination IP (required if action is forward)
    examples:
      - input: "nat descriptor masquerade incoming 1 reject"
        expected:
          descriptor_id: 1
          incoming_action: reject
        description: Reject unmatched incoming packets
      - input: "nat descriptor masquerade incoming 1 forward 192.168.1.100"
        expected:
          descriptor_id: 1
          incoming_action: forward
          forward_ip: "192.168.1.100"
        description: Forward unmatched packets to DMZ host

  # 23.11 Masquerade Port Range
  - name: nat descriptor masquerade port range
    syntax: "nat descriptor masquerade port range <nat_descriptor> <port_range1> [<port_range2> [<port_range3> [<port_range4>]]]"
    no_form: "no nat descriptor masquerade port range <nat_descriptor>"
    chapter: 23
    section: "23.11"
    parser: nat_masquerade.go
    description: Set port number range for IP masquerade
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: port_range1
        type: port_range
        required: true
        description: Primary port range (used first)
      - name: port_range2
        type: port_range
        required: false
        description: Secondary port range
      - name: port_range3
        type: port_range
        required: false
        description: Tertiary port range
      - name: port_range4
        type: port_range
        required: false
        description: Quaternary port range
    examples:
      - input: "nat descriptor masquerade port range 1 60000-64095"
        expected:
          descriptor_id: 1
          port_ranges: ["60000-64095"]
        description: Basic port range setting
      - input: "nat descriptor masquerade port range 1 60000-64095 49152-59999"
        expected:
          descriptor_id: 1
          port_ranges: ["60000-64095", "49152-59999"]
        description: Extended port range

  # 23.7 Masquerade rlogin Setting
  - name: nat descriptor masquerade rlogin
    syntax: "nat descriptor masquerade rlogin <nat_descriptor> <use>"
    no_form: "no nat descriptor masquerade rlogin <nat_descriptor>"
    chapter: 23
    section: "23.7"
    parser: nat_masquerade.go
    description: Enable/disable rlogin, rcp, and ssh through IP masquerade
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: use
        type: enum
        required: true
        values: [on, off]
        default: "off"
        description: Enable (on) or disable (off) rlogin/rcp/ssh
    examples:
      - input: "nat descriptor masquerade rlogin 1 on"
        expected:
          descriptor_id: 1
          rlogin: on
        description: Enable rlogin/rcp/ssh through masquerade

  # 23.17 Session Limit per Host
  - name: nat descriptor masquerade session limit
    syntax: "nat descriptor masquerade session limit <nat_descriptor> <id> <limit>"
    no_form: "no nat descriptor masquerade session limit <nat_descriptor> <id>"
    chapter: 23
    section: "23.17"
    parser: nat_masquerade.go
    description: Set maximum sessions per host for IP masquerade
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: id
        type: int
        required: true
        values: [1]
        description: Session limit identifier (must be 1)
      - name: limit
        type: int
        required: true
        range: "1-65534"
        description: Maximum number of sessions per host
    examples:
      - input: "nat descriptor masquerade session limit 1 1 1000"
        expected:
          descriptor_id: 1
          session_limit: 1000
        description: Limit each host to 1000 sessions

  # 23.18 Total Session Limit
  - name: nat descriptor masquerade session limit total
    syntax: "nat descriptor masquerade session limit total <nat_descriptor> <limit>"
    no_form: "no nat descriptor masquerade session limit total <nat_descriptor>"
    chapter: 23
    section: "23.18"
    parser: nat_masquerade.go
    description: Set total maximum sessions for NAT descriptor
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: limit
        type: int
        required: true
        range: "1-2147483647"
        description: Maximum total number of sessions
    examples:
      - input: "nat descriptor masquerade session limit total 1 50000"
        expected:
          descriptor_id: 1
          total_session_limit: 50000
        description: Limit total sessions to 50000

  # 23.14 NAT Log
  - name: nat descriptor log
    syntax: "nat descriptor log <switch>"
    no_form: "no nat descriptor log"
    chapter: 23
    section: "23.14"
    parser: nat_masquerade.go
    description: Enable/disable NAT address assignment logging
    parameters:
      - name: switch
        type: enum
        required: true
        values: [on, off]
        default: "off"
        description: Enable (on) or disable (off) logging
    examples:
      - input: "nat descriptor log on"
        expected:
          log: on
        description: Enable NAT logging

  # 23.15 SIP NAT
  - name: nat descriptor sip
    syntax: "nat descriptor sip <nat_descriptor> <sip>"
    no_form: "no nat descriptor sip <nat_descriptor>"
    chapter: 23
    section: "23.15"
    parser: nat_masquerade.go
    description: Enable/disable rewriting IP addresses in SIP messages
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: sip
        type: enum
        required: true
        values: [on, off, auto]
        default: auto
        description: Enable (on), disable (off), or auto based on sip use command
    examples:
      - input: "nat descriptor sip 1 on"
        expected:
          descriptor_id: 1
          sip: on
        description: Enable SIP address rewriting

  # 23.16 DF Bit Removal
  - name: nat descriptor masquerade remove df-bit
    syntax: "nat descriptor masquerade remove df-bit <remove>"
    no_form: "no nat descriptor masquerade remove df-bit"
    chapter: 23
    section: "23.16"
    parser: nat_masquerade.go
    description: Enable/disable DF bit removal during IP masquerade
    parameters:
      - name: remove
        type: enum
        required: true
        values: [on, off]
        default: "on"
        description: Remove (on) or keep (off) DF bit
    examples:
      - input: "nat descriptor masquerade remove df-bit on"
        expected:
          remove_df_bit: on
        description: Remove DF bit during masquerade (default)

  # 23.12 FTP Port
  - name: nat descriptor ftp port
    syntax: "nat descriptor ftp port <nat_descriptor> <port> [<port>...]"
    no_form: "no nat descriptor ftp port <nat_descriptor>"
    chapter: 23
    section: "23.12"
    parser: nat_masquerade.go
    description: Set port numbers recognized as FTP control channel
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: port
        type: port
        required: true
        default: 21
        description: Port number(s) for FTP control channel
    examples:
      - input: "nat descriptor ftp port 1 21 2121"
        expected:
          descriptor_id: 1
          ftp_ports: [21, 2121]
        description: Set FTP ports to 21 and 2121

  # 23.13 Unconvertible Port
  - name: nat descriptor masquerade unconvertible port
    syntax: "nat descriptor masquerade unconvertible port <nat_descriptor> <protocol> <port>"
    no_form: "no nat descriptor masquerade unconvertible port <nat_descriptor> <protocol>"
    chapter: 23
    section: "23.13"
    parser: nat_masquerade.go
    description: Set port numbers that should not be converted by IP masquerade
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: protocol
        type: enum
        required: true
        values: [tcp, udp]
        description: Protocol (tcp or udp)
      - name: port
        type: port_range
        required: true
        description: Port number range not to convert
    examples:
      - input: "nat descriptor masquerade unconvertible port 1 tcp 1024-65535"
        expected:
          descriptor_id: 1
          protocol: tcp
          unconvertible_port: "1024-65535"
        description: Do not convert high TCP ports

  # 23.13 Unconvertible Port if-possible
  - name: nat descriptor masquerade unconvertible port if-possible
    syntax: "nat descriptor masquerade unconvertible port <nat_descriptor> if-possible"
    no_form: "no nat descriptor masquerade unconvertible port <nat_descriptor> if-possible"
    chapter: 23
    section: "23.13"
    parser: nat_masquerade.go
    description: Keep original port number if not in use
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
    examples:
      - input: "nat descriptor masquerade unconvertible port 1 if-possible"
        expected:
          descriptor_id: 1
          unconvertible_if_possible: true
        description: Preserve port numbers when possible

  # 23.1 NAT Backward Compatibility
  - name: nat descriptor backward-compatibility
    syntax: "nat descriptor backward-compatibility <type>"
    no_form: "no nat descriptor backward-compatibility"
    chapter: 23
    section: "23.1"
    parser: nat_masquerade.go
    description: Set NAT operation mode for port-saving IP masquerade
    parameters:
      - name: type
        type: enum
        required: true
        values: ["1", "2", "3"]
        description: |
          Operation type:
          - 1: Disable port-saving IP masquerade
          - 2: Enable for TCP only
          - 3: Enable for TCP and UDP
    examples:
      - input: "nat descriptor backward-compatibility 2"
        expected:
          backward_compatibility: 2
        description: Enable port-saving for TCP

  # Port-based Static NAT (from parser)
  - name: nat descriptor static port
    syntax: "nat descriptor static <nat_descriptor> <outer_ip>:<port>=<inner_ip>:<port> <protocol>"
    no_form: "no nat descriptor static <nat_descriptor> <outer_ip>:<port>=<inner_ip>:<port> <protocol>"
    chapter: 23
    section: "23.6"
    parser: nat_static.go
    description: Set port-based static NAT mapping
    parameters:
      - name: nat_descriptor
        type: int
        required: true
        range: "1-2147483647"
        description: NAT descriptor number
      - name: outer_ip
        type: ipv4
        required: true
        description: Outer (external) IP address
      - name: outer_port
        type: port
        required: true
        description: Outer port number
      - name: inner_ip
        type: ipv4
        required: true
        description: Inner (internal) IP address
      - name: inner_port
        type: port
        required: true
        description: Inner port number
      - name: protocol
        type: enum
        required: true
        values: [tcp, udp]
        description: Protocol (tcp or udp)
    examples:
      - input: "nat descriptor static 1 203.0.113.1:80=192.168.1.100:8080 tcp"
        expected:
          descriptor_id: 1
          outside_global: "203.0.113.1"
          outside_global_port: 80
          inside_local: "192.168.1.100"
          inside_local_port: 8080
          protocol: tcp
        description: Port-based static NAT for HTTP
      - input: "nat descriptor static 2 203.0.113.1:443=192.168.1.100:443 tcp"
        expected:
          descriptor_id: 2
          outside_global: "203.0.113.1"
          outside_global_port: 443
          inside_local: "192.168.1.100"
          inside_local_port: 443
          protocol: tcp
        description: Port-based static NAT for HTTPS
